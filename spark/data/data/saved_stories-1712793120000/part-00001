{"aid": "39993686", "title": "Baby Jubjub", "url": "https://iden3-docs.readthedocs.io/en/latest/iden3_repos/research/publications/zkproof-standards-workshop-2/baby-jubjub/baby-jubjub.html", "domain": "iden3-docs.readthedocs.io", "votes": 1, "user": "anigbrowl", "posted_at": "2024-04-10 17:50:46", "comments": 0, "source_title": "Baby Jubjub \u2014 iden3 0.1 documentation", "source_text": "Baby Jubjub \u2014 iden3 0.1 documentation\n\n  * Docs \u00bb\n  * Research Papers \u00bb\n  * <no title> \u00bb\n  * Baby Jubjub\n  * Edit on GitHub\n\n# Baby Jubjub\u00b6\n\nContents\n\n  * Baby Jubjub\n\n    * Scope\n    * Motivation\n    * Background\n    * Terminology And Description\n\n      * Generation Of Baby Jubjub\n      * Definition Of Baby Jubjub\n      * Arithmetic In Baby Jubjub\n    * Challenges And Security\n    * Implementation\n    * Intellectual Property\n    * PDF Link\n\n1.2\n\n## Scope\u00b6\n\nThis proposal aims to define a specific elliptic curve defined over the large\nprime subgroup of BN128 elliptic curve.\n\n## Motivation\u00b6\n\nThe search for this elliptic curve defined is motivated by its usefulness in\nzk-SNARK proofs. Moreover the ability to find it in a deterministic way\u2014so\nthat it was clear no other considerations were taken for defining\u2014is paramount\nas it significantly reduces the possibility of a backdoor being present, thus\nleading to better security.\n\n## Background\u00b6\n\nWith this purpose, we used a deterministic algorithm for finding elliptic\ncurves over a specified finite field (Langley, Hamburg, and Turner, n.d.)\ntogether with the restrictions of security parameters described in SafeCurves\nproject (Bernstein and Lange, n.d.).\n\n## Terminology And Description\u00b6\n\n### Generation Of Baby Jubjub\u00b6\n\nIn 2016, a group of researchers of IRPF designed a deterministic algorithm\nthat, given a prime number pp, it returns the elliptic curve defined over\n\\ensuremathFp with smallest coefficient A such that A\u22122 is a multiple of 4 and\nequation y2=x3+Ax2+x describes a Montgomery curve. The assumption A\u22122\ndivisible by 4 comes from the fact that as this value is used in many\noperations, so trying to keep it smaller and divisible by four is a reasonable\nassumption (Langley, Hamburg, and Turner, n.d.).\n\nSafeCurves is a project that checks some of the most common and known attacks\non several elliptic curves. It also provides the algorithm it was used\n(Bernstein and Lange, n.d.).\n\nWe considered the large prime number dividing the order of BN128 and run\nalgorithm A.1 from (Langley, Hamburg, and Turner, n.d.). The first elliptic\ncurve it was returned satisfying SafeCurves criteria was the Montgomery curve\nwith coefficient A=168698. We named this curve Baby Jubjub elliptic curve.\n\n### Definition Of Baby Jubjub\u00b6\n\nFrom now on, let\n\np=21888242871839275222246405745257275088548364400416034343698204186575808495617and:math:\u2018\\ensuremathFp\u2018thefinitefieldwith:math:\u2018p\u2018\n\nelements.\n\n#### Montgomery Form\u00b6\n\nWe define EM as the Baby-Jubjub Montgomery elliptic curve defined over\n\\ensuremathFp given by equation\n\nE:v2=u3+168698u2+u.Theorderof:math:\u2018EM\u2018is:math:\u2018n=8\u00d7r\u2018,where\n\nr=2736030358979909402780800718157159386076813972158567259200215660948447373041isaprimenumber.Denoteby:math:\u2018\\ensuremathG\u2018the\n\nsubgroup of points of order r, that is,\n\n\\ensuremathG=\\SetP\u2208E(\\ensuremathFp)|rP=O.\n\n#### Edwards Form\u00b6\n\nEM is birationally equivalent to the Edwards elliptic curve\n\n> E:x2+y2=1+dx2y2where\n>\n>\n> d=9706598848417545097372247223557719406784115219466060233080913168975159366771.\n\nThe birational equivalence (Bernstein et al., n.d. Thm. 3.2) from E to EM is\nthe map\n\n> (x,y)\u2192(u,v)=(1+y1\u2212y,1+y(1\u2212y)x)withinversefrom:math:\u2018EM\u2018to:math:\u2018E\u2018\n>\n> (u,v)\u2192(x,y)=(uv,u\u22121u+1).\n\n### Arithmetic In Baby Jubjub\u00b6\n\nIn this section we define how to operate in the elliptic curve group: the\naddition of points and multiplication of a point by a scalar (an element of\n\\ensuremathFp).\n\n#### Addition Of Points\u00b6\n\nWhen adding points of elliptic curves in Montgomery form, one has to be\ncareful if the points being added are equal (doubling) or not (adding) and if\none of the points is the point at infinity (Okeya, Kurumatani, and Sakurai\n2000). Edwards curves have the advantage that there is no such case\ndistinction and doubling can be performed with exactly the same formula as\naddition (Bernstein et al., n.d.). In comparison, operating in Montgomery\ncurves is cheaper. In this section, we summarize how addition and doubling is\nperformed in both forms. For the exact number of operations required in\ndifferent forms of elliptic curves, see (Bernstein et al., n.d.).\n\n  * : Let P1=(x1,y1) and P2=(x2,y2) be points of the Baby-Jubjub twisted Edwards elliptic curve E. The sum P1+P2 is a third point P3=(x3,y3) with\n\n\u03bb=dx1x2y1y2,x3=(x1y2+y1x2)/(1+\u03bb),y3=(y1y2\u2212x1x2)/(1\u2212\u03bb).Notethattheneutralelementisthepoint:math:\u2018O=(0,1)\u2018andthe\n\ninverse of a point (x,y) is (\u2212x,y).\n\n  * : Let P1=(x1,y1)\u2260O and P2=(x2,y2)\u2260O be two points of the Baby-JubJub elliptic curve EM in Montgomery form.\n\nIf P1\u2260P2, then the sum P1+P2 is a third point P3=(x3,y3) with coordinates\n\n\u039b=(y2\u2212y1)/(x2\u2212x1),x3=\u039b2\u2212A\u2212x1\u2212x2,y3=\u039b(x1\u2212x3)\u2212y1.If:math:\u2018P1=P2\u2018,then:math:\u20182\u22c5P1\u2018isapoint\n\nP3=(x3,y3) with coordinates\n\n\u039b=(3x21+2Ax1+1)/(2y1),x3=\u039b2\u2212A\u22122x1,y3=\u039b(x1\u2212x3)\u2212y1.\n\n#### Multiplication Of A Point Of E By A Scalar\u00b6\n\nLet P\u2260O be a point of the Edwards curve E of order strictly greater than 8\n(i.e. P\u2208\\ensuremathG) and let k a binary number representing an element of\n\\ensuremathFp. We describe the circuit used to compute the point k\u22c5P.\n\n  1. First, we divide k into chunks of 248 bits. If k is not a multiple of 248, we take j segments of 248 bits and leave a last chunk with the remaining bits. More precisly, write\n\nk=k0k1...kjwith{ki=bi0bi1...bi247 for i=0,...,j\u22121,kj=bj0bj1...bjs with\ns\u2264247.Then,\n\nk\u22c5P=k0\u22c5P+k1\u22c52248P+\u22ef+kj\u22c52248jP.Thissumisdoneusingthefollowingcircuit.Thetermsofthesum\n\nare calculated separately inside the seq boxes and then added together.\n\n  2. Each seq box takes a point of E of the from Pi=2248iP for i=0,...,j\u22121 and outputs two points\n\n2248\u22c5Piand247\u2211n=0bn\u22c52n\u22c5Pi.Thefirstpointistheinputofthenext:math:\u2018(i+1)\u2018\u2212thseqbox\n\n(note that 2248\u22c5Pi=Pi+1) whereas the second output is the computation of the\ni-th term in expression ([kP]). The precise circuit is depicted in next two\nfigures seq and window.\n\nThe idea of the circuit is to first compute\n\nQ=Pi+b1\u22c5(2Pi)+b2\u22c5(4Pi)+b3\u22c5(8Pi)+\u22ef+b247\u22c5(2247Pi),andoutputthepoint\n\nQ\u2212b0\u22c5Pi.Thispermitsthecomputationof:math:\u2018Q\u2018usingtheMontgomeryform\n\nof Baby-Jubjub and only use twisted Edwards for the second calculation. The\nreason to change forms is that, in the calculation of the output, we may get a\nsum with input the point at infinity if b0=0.\n\nStill, we have to ensure that none of the points being doubled or added when\nworking in EM is the point at infinity and that we never add the same two\npoints.\n\n     * By assumption, P\u2260O and ord(P)>8\\. Hence, by Lagrange theorem (Baumslag and Chandler 1968 Corollary 4.12), P must have order r, 2r, 4r or 8r. For this reason, none of the points in EM being doubled or added in the circuit is the point at infinity, because for any integer m, 2m is never a multiple of r, even when 2m is larger than r, as r is a prime number. Hence, 2m\u22c5P\u2260O for any m\u2208\\ensuremathZ.\n     * Looking closely at the two inputs of the sum, it is easy to realize that they have different parity, one is an even multiple of Pi and the other an odd multiple of Pi, so they must be different points. Hence, the sum in EM is done correctly.\n  3. The last term of expression ([kP]) is computed in a very similar manner. The difference is that the number of bits composing kj may be shorter and that there is no need to compute Pj+1, as there is no other seq box after this one. So, there is only output, the point kj\u22c5Pj=kj\u22c52248jP. This circuit is named seq\u2019.\n\n## Challenges And Security\u00b6\n\nAs required in the construction of Baby-Jubjub, the curve satisfies SafeCurves\ncriteria. This can be checked following (Hat, n.d.).\n\n## Implementation\u00b6\n\nBarry WhiteHat:\n\n  * https://github.com/barryWhiteHat/baby_jubjub\n  * https://github.com/barryWhiteHat/baby_jubjub_ecc\n\nJordi Baylina: https://github.com/iden3/circomlib/blob/master/src/babyjub.js\n\n## Intellectual Property\u00b6\n\nWe will release the final version of this proposal under creative commons, to\nensure it is freely available to everyone.\n\nBaumslag, Benjamin, and Bruce Chandler. 1968. Schaum\u2019s Outline of Theory and\nProblems of Group Theory. Schaum\u2019s Outline Series. New York: McGraw-Hill Book\nCompany.\n\nBernstein, Daniel J., Peter Birkner, Marc Joye, Tanja Lange, and Christiane\nPeters. n.d. \u201cTwisted Edwards Curves.\u201d Cryptology ePrint Archive, Report\n2008/013.\n\nBernstein, Daniel J., and Tanja Lange. n.d. \u201cSafeCurves: Choosing Safe Curves\nfor Elliptic-Curve Cryptography.\u201d\n\nHat, Barry White. n.d. \u201cBaby-Jubjub Supporting Evidence.\u201d GitHub.\n\nLangley, Adam, Mike Hamburg, and Sean Turner. n.d. \u201cElliptic Curves for\nSecurity.\u201d Request for Comments. RFC 7748; RFC Editor.\nhttps://doi.org/10.17487/RFC7748.\n\nOkeya, Katsuyuki, Hiroyuki Kurumatani, and Kouichi Sakurai. 2000. \u201cElliptic\nCurves with the Montgomery-Form and Their Cryptographic Applications.\u201d In\nProceedings of the Third International Workshop on Practice and Theory in\nPublic Key Cryptography: Public Key Cryptography, 238\u201357. PKC \u201900. London, UK,\nUK: Springer-Verlag. http://dl.acm.org/citation.cfm?id=648117.746614.\n\n## PDF Link\u00b6\n\nBaby Jub-jub\n\nNext Previous\n\n\u00a9 Copyright 2019; Iden3 (CC-BY-SA 4.0] Revision 4decd7c6.\n\nBuilt with Sphinx using a theme provided by Read the Docs.\n\nRead the Docs v: latest\n\nVersions\n\n    latest\n\nDownloads\n\n    HTML\n    Epub\n\nOn Read the Docs\n\n    Project Home\n    Builds\n    Downloads\n\nOn GitHub\n\n    View\n    Edit\n\nSearch\n\nHosted by Read the Docs \u00b7 Privacy Policy\n\n", "frontpage": false}
