{"aid": "39983414", "title": "What is Authenticated Received Chain and why does it matter?", "url": "https://proton.me/blog/what-is-authenticated-received-chain-arc", "domain": "proton.me", "votes": 1, "user": "aragonite", "posted_at": "2024-04-09 19:45:34", "comments": 0, "source_title": "What is Authenticated Received Chain (ARC) and why does it matter? | Proton", "source_text": "What is Authenticated Received Chain (ARC) and why does it matter? | Proton\n\n(new window)\n\nSign inCreate a free account\n\n(new window)\n\n  * Proton news(new window)\n  * Privacy news(new window)\n  * Privacy basics(new window)\n  * Privacy deep dives(new window)\n  * Opinion(new window)\n  * For business(new window)\n\nSubscribe by RSS\n\nCreate a free account\n\n  * Privacy basics(new window)\n\n# What is Authenticated Received Chain (ARC) and why does it matter?\n\nHarry Bone(new window)\n\nShare this page\n\n  * (new window)\n  * (new window)\n  * (new window)\n  * (new window)\n\nLast update on September 12, 2023 Published on June 30, 2023\n\nARC allows email providers to verify that emails are genuine when they\u2019re\nforwarded or sent from a mailing list.\n\nWe all suffer from spam(new window), and anyone can fall victim to\nphishing(new window). And if you have your own email domain (like\n@yourname.com), fraudsters could spoof(new window) (forge) it to launch spam\nand phishing attacks.\n\nThat\u2019s why leading email providers use authentication methods like SPF(new\nwindow), DKIM(new window), and DMARC(new window) to verify emails and fight\nspam, spoofing, and phishing.\n\nBut these protocols aren\u2019t infallible. Learn how ARC solves a basic problem\nwith email authentication, improving email deliverability and security.\n\nWhat is Authenticated Received Chain (ARC)? What problem does ARC solve? What\ndoes ARC do? How does ARC work? ARC email example Why use ARC? Final thoughts\nARC FAQs\n\n## What is Authenticated Received Chain (ARC)?\n\nAuthenticated Received Chain (ARC) is an email authentication method that\nallows receiving mail servers to check the authentication results of an email\nwhen it\u2019s forwarded or relayed by an intermediate server.\n\nA relatively new protocol formalized in 2019(new window), ARC has come to play\na small but significant role in message filtering at leading email providers\nlike Proton Mail. To understand ARC and why it matters, you need to grasp a\nbasic problem with email authentication.\n\n## What problem does ARC solve?\n\nARC solves a specific issue with the three main email authentication methods:\n\n  * SPF (Sender Policy Framework)(new window)\n  * DKIM (DomainKeys Identified Mail)(new window)\n  * DMARC (Domain-based Message Authentication, Reporting, and Conformance)(new window)\n\n### DMARC verifies SPF and DKIM\n\nSPF verifies that an email has been sent from an IP address authorized to send\nemails from the sender\u2019s domain.\n\nDKIM cryptographically verifies that the sender\u2019s address and message contents\nhaven\u2019t been changed in transit.\n\nHowever, with SPF and DKIM alone, you can\u2019t be sure that the sender\u2019s domain\nin the From field hasn\u2019t been spoofed (forged).\n\nTherefore, DMARC was introduced to ensure that the domain in DKIM and SPF\nchecks matches the sender\u2019s domain. It also specifies how email servers should\nhandle a message that fails both DKIM and SPF \u2014 accept, reject, or mark it as\nspam.\n\nNow widely adopted by major email providers like Google, Microsoft, and\nProton, DMARC has significantly improved the deliverability of emails\nauthenticated by SPF and DKIM.\n\nSo what\u2019s the problem?\n\n### Intermediaries can break DMARC\n\nWhen you send an email, it passes through various SMTP(new window) mail\nservers in a series of \u201chops\u201d from sender A to recipient B. The issue is that\nDMARC assumes that emails are sent directly from A to B unchanged.\n\nIn reality, some intermediate mail servers may legitimately change a message\nin transit, for example:\n\n  * When forwarding it: The forwarder may edit the original message, or the server may change email header(new window) fields.\n  * When sending it via a mailing list: The mailing list may add the list\u2019s name to the Subject line or an \u201cunsubscribe\u201d link or disclaimer in the message footer.\n\nAs a result, these legitimate emails appear to have been tampered with and can\nfail DKIM checks(new window).\n\nSimilarly, as forwarding or mailing list mail servers send messages from a new\nIP address, these messages can fail SPF(new window).\n\nAnd if a message fails both DKIM and SPF, it fails DMARC(new window) and is\neither rejected or treated with suspicion.\n\nEmail authentication without ARC\n\nThis is where ARC comes in \u2014 to solve the problem of authentication failures\ncaused by legitimate intermediaries.\n\n## What does ARC do?\n\nARC preserves the original authentication results from the first hop of an\nemail\u2019s journey and verifies the identity of each intermediate server along\nthe way.\n\nWhen an email passes through a trusted intermediate server, the server\ndigitally signs(new window) the message and adds this ARC signature to the\nemail header(new window). For each hop of a message\u2019s journey from A to B,\ntrusted intermediate servers add their signature, forming a chain of ARC\nsignatures.\n\nBy checking this \u201cchain of custody\u201d or authenticated received chain, the\nrecipient\u2019s email server can see the original authentication results. It can\nalso verify that any changes to the email in transit were signed by a trusted\nintermediary.\n\n## How does ARC work?\n\nARC adds three extra email headers(new window) to messages to create a chain\nof trust back to the original message.\n\nHere are the three ARC headers and a simplified explanation of what they\ncontain.\n\nARC header| What it contains  \n---|---  \nARC-Authentication-Results| A copy of the email\u2019s authentication results: SPF,\nDKIM, and DMARC  \nARC-Message-Signature| A digital signature similar to a DKIM signature(new\nwindow) comprising the whole message and headers (except the ARC-Seal header)  \nARC-Seal| A DKIM-like signature comprising the ARC headers generated by each\nintermediate server  \nAuthenticated Received Chain headers\n\nHere\u2019s how ARC headers appear in an email header(new window):\n\nARC headers example\n\n### How intermediate servers sign the message\n\nFor every hop of the message\u2019s journey, each intermediate mail server:\n\n  * Copies the original Authentication-Results(new window) into a new ARC-Authentication-Results header and adds a sequence number starting with i=1 (showing the order of the servers)\n  * Generates an ARC-Message-Signature, including the sequence number\n  * Generates an ARC-Seal, which validates the authenticity of each intermediate server\u2019s contribution to the ARC chain\n\nIn this way, if an intermediate email server alters a message, it digitally\nsigns(new window) the change to verify that the change is legitimate.\n\n### How the receiving server validates ARC\n\nIf the recipient\u2019s mail server sees a message has failed DMARC, it can check\nthe ARC result by:\n\n  * Validating the chain of ARC-Seal headers\n  * Validating the latest ARC-Message-Signature (based on the sequence number)\n\nIf all are valid, the message passes ARC. If the receiving server trusts all\nthe intermediate servers in the ARC chain, the server may accept the message\neven if it has failed DMARC.\n\nAt Proton, we currently only accept messages that fail DMARC for a limited set\nof parties that we trust to implement ARC correctly. We set two conditions:\n\n  * The message must pass ARC, and\n  * The ARC-Authentication-Results must show that the message passed DMARC at the first \u201chop\u201d before it was forwarded.\n\n## ARC email example\n\nHere\u2019s an example of how ARC works: a message sent to a mailing list.\n\nARC email example: mailing list\n\n1\\. You send your email to a mailing list address (from an email provider\u2019s\npublished IP address, for example, 185.70.40.111).\n\n2\\. The mailing list\u2019s intermediate server receives the message and carries\nout SPF, DKIM, and DMARC checks. The message passes all checks.\n\n3\\. The mailing list server now changes the content, adding the mailing list\nname (for example, \u201cTeam member news\u201d) to the Subject line and an\n\u201cunsubscribe\u201d link in the footer. Because it has changed the content, the\nserver adds ARC headers to the message to preserve the authentication results.\n\n4\\. The recipient\u2019s mail server receives the message, but it fails\nauthentication:\n\n  * DKIM fails because the message\u2019s content has been changed.\n  * SPF fails because the new IP address (211.22.33.44) isn\u2019t in the SPF record(new window).\n  * DMARC fails as both the above have failed.\n\n5\\. The server checks the ARC results and validates the ARC chain.\n\n6\\. If the server validates ARC and all the ARC signatures in the chain are\nfrom trusted parties, it may override the DMARC failure and deliver the\nmessage.\n\n## Why use ARC?\n\nThe chain of trust that ARC creates has several benefits for email providers\nand users.\n\n### Improves email deliverability\n\nAs ARC preserves the original authentication results, it ensures that\nlegitimate emails aren\u2019t marked as spam or rejected. This also allows email\nproviders to set a stricter DMARC policy(new window).\n\n### Bolsters email security\n\nARC allows receiving mail servers to verify the authenticity of emails even if\nthey fail other authentication checks. This reduces the risk of email\nspoofing(new window) and phishing attacks.\n\n### Helps email troubleshooting\n\nARC signatures give a record of the intermediaries on an email\u2019s journey. This\ncan help providers analyze and resolve email delivery issues.\n\n## Final thoughts\n\nBuilding on SPF, DKIM, and DMARC authentication, ARC solves the problem of\nemail authentication failures when emails are forwarded or otherwise relayed\nby intermediate servers.\n\nARC allows the recipient\u2019s server to accept legitimate messages that would\notherwise be rejected or marked spam, improving email deliverability and\nsecurity.\n\nAt Proton Mail, ARC is one of the tools we use to optimize our message\nfiltering, helping to protect you from spam and phishing attacks. So join us\nand stay secure!\n\n## Authenticated Received Chain (ARC) FAQs\n\n### Can ARC be used instead of other email authentication methods like SPF,\nDKIM, and DMARC?\n\nNo, ARC can\u2019t replace these methods but complements them. ARC preserves the\nresults of these authentication protocols as emails pass from one intermediate\nserver to another.\n\n### Do all email providers implement ARC?\n\nNo, not all. First introduced in 2019, ARC is a relatively new protocol.\nHowever, major email providers like Gmail, Outlook, and Proton Mail now use\nARC to filter messages, and adoption is growing among other providers.\n\n### Can ARC signatures be forged or altered?\n\nARC signatures use public-key cryptography(new window) to prevent tampering\nand forgery. But as with any security protocol, they must be implemented\ncorrectly to prevent unauthorized access to the encryption keys.\n\nOverall, ARC is secure when configured correctly, but intermediate servers can\nalways inject harmful content into ARC headers or remove some or all the\nheaders. ARC only works because trusted intermediaries sign the ARC chain.\n\n### Does ARC provide end-to-end encryption for emails?\n\nNo, ARC is designed to address problems with authenticating emails when\nthey\u2019re forwarded or relayed by intermediate servers. For end-to-end\nencryption(new window), you need to use an encryption method like PGP(new\nwindow).\n\nThe easiest way to get secure email with end-to-end encryption and ARC is to\nsign up for Proton Mail.\n\nSecure your emails, protect your privacy\n\nGet Proton Mail free\n\nShare this page\n\n  * (new window)\n  * (new window)\n  * (new window)\n  * (new window)\n\nHarry Bone(new window)\n\nA long-standing privacy advocate, Harry worked as a translator and writer in a\nrange of industries, including a stint in Moscow monitoring the Russian media\nfor the BBC. He joined Proton to promote privacy, security, and freedom for\neveryone online.\n\n## Related articles\n\n  * Privacy deep dives\n\nBig Tech passkey implementations are a trap(new window)\n\nWe recently announced that Proton Pass now supports passkeys for everyone\nacross all devices. Universal compatibility is a unique approach to\nimplementing passkeys, unfortunately. Even though passkeys were developed by\nthe FIDO Alliance and the Worl\n\n  * Privacy basics\n\nHow to upload and share private videos securely(new window)\n\nYour private videos are for your eyes only. However, not all cloud storage\nservices are good at storing videos securely, let alone privately. In this\narticle we explain what you can do to keep file sharing companies from having\naccess to the videos y\n\n  * Privacy basics\n\nCreate an email account without phone number verification(new window)\n\nMany email services, citing security reasons, require a phone number for\nidentity verification. This creates an unfortunate paradox in which you must\ngive up a highly sensitive piece of personal data to Big Tech. But there are\nsimple ways to create\n\n  * Privacy basics\n\nCan you password-protect a folder in Google Drive?(new window)\n\nProtecting a folder with a password is a simple yet effective way of securing\nfiles. You may wonder whether you can password-protect a folder in Google\nDrive. We explain what access controls Google Drive offers and what you can do\nto improve your sec\n\n  * Proton news\n\nProton Pass now supports passkeys on all devices and plans(new window)\n\nWe\u2019re excited to announce that Proton Pass supports passkeys for everyone,\nallowing you to manage and use passkeys across all devices seamlessly.\nPasskeys are an easy and secure alternative to traditional passwords that can\nhelp prevent phishing atta\n\n  * Privacy basics\n\nWhat is a passkey?(new window)\n\nPasskeys are a new way to secure your online accounts using cryptographic keys\ninstead of passwords. They offer a high level of convenience and security, and\nare a real game-changer in the way we access and secure sites. What is a\npasskey, though, an\n\n  * Privacy deep dives\n\nYour iPhone is not as private as you might think(new window)\n\nApple\u2019s marketing team has built a powerful association between the iPhone and\nprivacy. The company\u2019s ad campaigns claim that \u201cwhat happens on your iPhone,\nstays on your iPhone.\u201d And, \u201cPrivacy. That\u2019s iPhone.\u201d But Apple\u2019s lawyers are\ntelling a diffe\n\nProton - Privacy by default\n\n  * (new window)\n  * (new window)\n  * (new window)\n  * (new window)\n  * (new window)\n  * (new window)\n  * (new window)\n  * (new window)\n\nProton AG\n\nRoute de la Galaise 32 1228 Plan-les-Ouates Geneva, Switzerland\n\nBuilt with support from\n\nSchweizerische Eidgenossenschaft\n\nConf\u00e9d\u00e9ration Suisse\n\nConfederazione Svizzera\n\nConfederaziun Svizra\n\nSwiss Confederation\n\nInnosuisse - Swiss Innovation Agency\n\nThis project is supported by the European Union\u2019s Horizon 2020 program (Grant\nNo 848554)\n\n  * System status(new window)\n  * Report abuse\n  * Report a problem\n  * Report a security issue\n  * Request a feature(new window)\n\n  * Privacy policy\n  * Terms & conditions\n  * Transparency report\n  * \u00a9 2024 Proton AG. All rights reserved.\n\n", "frontpage": false}
