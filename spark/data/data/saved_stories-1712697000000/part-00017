{"aid": "39977862", "title": "SSSL \u2013 Hackless SSL bypass for the Wii U", "url": "https://github.com/PretendoNetwork/SSSL", "domain": "github.com/pretendonetwork", "votes": 14, "user": "todsacerdoti", "posted_at": "2024-04-09 10:03:53", "comments": 4, "source_title": "GitHub - PretendoNetwork/SSSL", "source_text": "GitHub - PretendoNetwork/SSSL\n\nSkip to content\n\nSign in\n\n# Search code, repositories, users, issues, pull requests...\n\nSearch syntax tips\n\nSign in\n\nSign up\n\nYou signed in with another tab or window. Reload to refresh your session. You\nsigned out in another tab or window. Reload to refresh your session. You\nswitched accounts on another tab or window. Reload to refresh your session.\nDismiss alert\n\nPretendoNetwork / SSSL Public\n\n  * Notifications\n  * Fork 1\n  * Star 22\n\n### License\n\nGPL-3.0 license\n\n22 stars 1 fork Branches Tags Activity\n\nStar\n\nNotifications\n\n# PretendoNetwork/SSSL\n\nThis commit does not belong to any branch on this repository, and may belong\nto a fork outside of the repository.\n\n1 Branch\n\n0 Tags\n\n## Folders and files\n\nName| Name| Last commit message| Last commit date  \n---|---|---|---  \n  \n## Latest commit\n\njonbarrowMerge pull request #1 from CenTdemeern1/patch-149fc689 \u00b7\n\n## History\n\n24 Commits  \n  \n### .eslintrc.json\n\n|\n\n### .eslintrc.json\n\n| added eslint  \n  \n### .gitignore\n\n|\n\n### .gitignore\n\n| Initial testing  \n  \n### LICENSE\n\n|\n\n### LICENSE\n\n| chore: add LICENSE and README  \n  \n### README.md\n\n|\n\n### README.md\n\n| Fix typo  \n  \n### package-lock.json\n\n|\n\n### package-lock.json\n\n| added eslint  \n  \n### package.json\n\n|\n\n### package.json\n\n| added eslint  \n  \n### patch.js\n\n|\n\n### patch.js\n\n| fix linter errors  \n  \n### shutter.png\n\n|\n\n### shutter.png\n\n| update: add shutter image to README  \n  \n## Repository files navigation\n\n# SSSL - Hackless SSL bypass for the Wii U\n\nOn March 1, 2021 Nintendo released Wii U firmware version 5.5.5. This update\nupdated the Wii U's SSL verification and recompiled all RPLs (though no code\nchanges were made). The exact purpose for this update is unknown, as nothing\nof significance was changed, and no other changes were made in this update.\nWith the changes to SSL verification, Nintendo introduced a bug which allows\nfor the forging of SSL certificates. These forged certificates will be seen as\n\"Nintendo Signed\" and, due to an existing bug with how the Wii U handles CA\ncommon names, will be accepted by all domains.\n\n## The bugs\n\nThere are 2 bugs at play:\n\n  1. Normally a CA common name does not accept a single wildcard (*) value. They must contain a hostname, and optionally one or many wildcards for subdomains. The Wii U will accept a single * wildcard in place of a hostname, which allows the CA to be accepted as any domain. This bug has existed since before 5.5.5, but was not useful until now.\n  2. As of 5.5.5, CA's crafted in a specific way may take a newly introduced alternate path for verification. This allows for a CA's signature to not be verified correctly. Instead, the Wii U simply checks if the CA matches one already known by the system, but not the signature or contents of the CA. We have no idea why this change was made, as it does not benefit Nintendo at all. It almost feels intentional.\n\n## Exploiting\n\nNot any CA will work. There are 3 conditions for a CA which still need to be\nmet even for a forged CA to be accepted:\n\n  1. The CA needs to be one which the Wii U would already accept. The signature is not validated in this case, so modifying an existing CA works.\n  2. The Wii U does not allow a Root CA in the cert chain. It will ignore any certs that have a matching subject and authority key.\n  3. The title must not roll it's own SSL. WebKit titles such as the eShop, Miiverse, TVii, etc, as well as any game which uses it's own SSL library, will not work with these certificates.\n\nThe easiest way to exploit this bug is to use the Nintendo CA - G3 CA, and is\nwhat this script opts to do. This can be dumped from a Wii U's SSL\ncertificates title at\n/storage_mlc/sys/title/0005001b/10054000/content/scerts/CACERT_NINTENDO_CA_G3.der.\nChanging the public key to a user-controlled key and changing the authority\nkey identifier to anything else is all that is required. The resulting user-\ncontrolled private key and patched CA can be used to bypass SSL verification\nwithout any homebrew or CFW at all.\n\n## The script\n\nThis script takes in a PEM encoded copy of Nintendo CA - G3 and does the above\npatches and exports the patched CA and private key.\n\n  * Install NodeJS\n  * git clone https://github.com/PretendoNetwork/SSSL\n  * cd SSSL\n  * npm i to install the dependencies\n  * node patch to run the patching wizard\n\n## Credits\n\n  * Shutterbug for actually finding the new verification bug\n  * Jemma and Quarky for decompiling the updated SSL functions\n\n## About\n\nNo description, website, or topics provided.\n\n### Resources\n\nReadme\n\n### License\n\nGPL-3.0 license\n\nActivity\n\nCustom properties\n\n### Stars\n\n22 stars\n\n### Watchers\n\n6 watching\n\n### Forks\n\n1 fork\n\nReport repository\n\n## Releases\n\nNo releases published\n\n## Packages 0\n\nNo packages published\n\n## Contributors 2\n\n  * jonbarrow Jonathan Barrow\n  * CenTdemeern1 Charlotte Herngreen\n\n## Languages\n\n  * JavaScript 100.0%\n\n## Footer\n\n\u00a9 2024 GitHub, Inc.\n\nYou can\u2019t perform that action at this time.\n\n", "frontpage": true}
