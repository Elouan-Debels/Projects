{"aid": "39996314", "title": "Why Can't My Mom Email Me?", "url": "https://matduggan.com/why-cant-my-mom-email-me/", "domain": "matduggan.com", "votes": 30, "user": "FiloSottile", "posted_at": "2024-04-10 22:21:48", "comments": 5, "source_title": "Why Can't My Mom Email Me?", "source_text": "Why Can't My Mom Email Me?\n\nMenu\n\nArticle email\n\n# Why Can't My Mom Email Me?\n\n#### Mathew Duggan\n\n10 Apr 2024 \u2022 5 min read\n\nAn investigation into Proton encrypted email.\n\n### Suddenly Silence\n\nI'm a big user of email, preferring long chains to messaging apps for a lot of\nmy friends and contacts. It's nice that it isn't tied to a single device or\nplatform and since I own my domain, I can move it from service to service\nwhenever I want and the sender doesn't have to learn some new address. However\nin the last two months I suddenly stopped getting emails from a percentage of\nmy friends and even my mom.\n\nWhat I was getting instead was PGP encrypted emails with blank bodies that\nlooked like the following:\n\nIf I inspected the message, it was clearly an encrypted email which Fastmail\ndoesn't support. They have a whole blog post on why they don't here:\nhttps://www.fastmail.com/blog/why-we-dont-offer-pgp/ but up to this point I\nhaven't really cared one way or the other since nobody sends me encrypted\nemails.\n\nNow I knew that Proton would send encrypted emails to other Proton email\naddresses, but obviously this isn't a Proton hosted email address which it\nwould be able to tell pretty easily with DNS. Then it got even stranger when I\ntried my work email and got the same error.\n\nChecking the raw message and there it is, Proton has encrypted this email. Now\nthis address is hosted on Google Workspaces, so at this point I'm just\nbaffled. Can Proton email users not send emails to people on Google Workspaces\nemail addresses? That can't possibly be right? My friends and mom using Proton\nwould have noticed that their emails seem to always disappear into the ether\nfor the majority of the people they email.\n\nI open a ticket with Fastmail hoping they've seen this problem before, but no\nluck. Then I opened a ticket with Proton but didn't hear back as of the time\nof me writing this.\n\n### How Proton Seems To Work\n\nSo the reason why so many people I know are moving to Proton is they seem to\nbe the only game in town that has cracked sending encrypted emails in the\nleast annoying way possible. Their encryption uses asymmetric PGP key pairs\nwith lookup for other users public keys happening on their key server. This in\nconjunction with their Key Transparency technology that compares lookup\nrequests by the client with requests on the server-side allows for easy\nencrypted message exchanges with a high degree of safety, at least according\nto them.\n\nThere seems to be three classes of keys at Proton.\n\n  * User keys: encrypt account-specific stuff like contacts. Not shared.\n  * Address keys: for encrypting messages and data.\n  * Other keys: part of a key tree that leads back to the address key as the primary external key for people to use.\n\nSo that makes sense that Proton can lookup address keys for users on their\nsystem. But where are my keys coming from? So in their Proton Key Transparency\nwhitepaper they have this little snippet on page 10:\n\n> For External Addresses, the server may return email encryption keys that it\n> found in the Web Key Directory (WKD) [6] (since email is hosted elsewhere).\n> The server may also return data encryption keys, used e.g. for Proton Drive.\n> The former should have an absence proof in KT, and the latter should have an\n> inclusion proof. For Non-Proton Addresses, the server may also return keys\n> that it found in the WKD. This way clients can automatically encrypt emails\n> to it. These keys won\u2019t be in ProtonKT, thus KT should return an absence\n> proof.\n\n### What The Hell Is WKD?\n\nWKD, or OpenPGP Web Key Directory is an IETF draft by Werner Koch. It\ndescribes a service where you can lookup OpenPGP keys by mail addresses using\na service. It also allows the key owner and the mail provider to publish and\nrevoke keys. The whole thing is very clever, an interesting way to get around\nthe annoying parts of PGP encryption of email. You can read it here:\nhttps://www.ietf.org/archive/id/draft-koch-openpgp-webkey-service-16.txt\n\nIt outlines an enrollment process by which I would signal to a WKD service\nthat I have a key that I want to enroll into the process. The only problem is\nI never did that, or at least certainly can't remember doing that. I'm\ncertainly not hosting a page with any key verification stuff.\n\nThere seems to be a way to set a CNAME record to point towards\nkeys.openpgp.org where I do have a key set, but that isn't set up on my\ndomain.\n\n    \n    \n    nslookup openpgpkey.matduggan.com Server: 2a01:4f8:c2c:123f::1 Address: 2a01:4f8:c2c:123f::1#53 Non-authoritative answer: *** Can't find openpgpkey.matduggan.com: No answer\n    \n    123456\n\nSource here: https://keys.openpgp.org/about/usage\n\nI can't seem to find why Proton thinks they can use this key BUT I can confirm\nthis is the key they're encrypting the emails with.\n\n### What?\n\nSo it seems if your email address returns a key from keys.openpgp.org then\nProton will encrypt the message with your public key from there, even though\n(as far as I can tell) I haven't opted into them using this service. I also\ncan't seem to figure out a way to signal to them they shouldn't do it.\n\nAlright so what happens if I just remove my key from keys.openpgp.org. The\nprocess is pretty simple, just go to: https://keys.openpgp.org/manage and\nfollow the instructions in the email. It seems to work more or less instantly.\n\nAlright looks like we figured it out!\n\n### Proton Seriously What The Hell?\n\nI'm at a little bit of a loss here. I totally understand sending me encrypted\nemails if I've gone through the steps to set the CNAME that indicates that I\nwant to do that, but it doesn't seem like that's how the service works. As far\nas I can tell, the act of uploading a OpenPGP-compatible key seems to trigger\ntheir service to send it as an end-to-end encrypted message.\n\nI'll update this with whatever I hear back from Proton but in the meantime if\nyou stumble across this post after getting blank emails from people for\nmonths, you'll at least be able to fix it.\n\nIs there some flag I've accidentally set somewhere that tells Proton to send\nme encrypted emails? Let me know at: https://c.im/@matdevdug\n\nShare\n\nTopic email Personal\n\n## Why Don't I Like Git More?\n\nI've been working with git now full-time for around a...\n\n05 Apr 2024\n\n", "frontpage": true}
