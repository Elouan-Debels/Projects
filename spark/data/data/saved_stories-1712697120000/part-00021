{"aid": "39978393", "title": "How does the classic Win32 ListView handle incremental searching?", "url": "https://devblogs.microsoft.com/oldnewthing/20240408-00/?p=109627", "domain": "microsoft.com", "votes": 1, "user": "nikbackm", "posted_at": "2024-04-09 11:40:57", "comments": 0, "source_title": "How does the classic Win32 ListView handle incremental searching?", "source_text": "How does the classic Win32 ListView handle incremental searching? - The Old\nNew Thing\n\nSkip to main content\n\nMicrosoft\n\nThe Old New Thing\n\nThe Old New Thing\n\n  * Light\n  * Dark\n\nLogin\n\n# How does the classic Win32 ListView handle incremental searching?\n\nRaymond Chen\n\nApril 8th, 202410 0\n\nThe classic Win32 ListView supports incremental search: You can start typing\nthe name of an item to search for it. But it\u2019s a bit more complicated than\nthat.\n\nYou see, there\u2019s more than one way that people expect type-to-search to work.\nIn one pattern, you type the first letter of the thing you want, and the\nsystem finds the first item that starts with that letter. If that\u2019s not the\none you want, you press that same letter again, and the system finds the\nsecond item that starts with that letter. Keep pressing that same letter until\nyou get to the item you want. This is how list box searching worked in Windows\n1.0.\n\nAnother pattern is to type the first letter of the thing you want, and the\nsystem finds the first item that starts with that letter. If that\u2019s not the\none you want, then type the second letter of the thing you want, and the\nsystem finds the first item whose first two letters match the letters you\ntyped. Keep typing more and more letters until you get to the item you want.\n\nWhich pattern should the classic Win32 ListView control use?\n\nWhy not both?\n\nIf you type the same letter over and over again, then the classic Win32\nListView assumes that you are using the first pattern, and each time you press\nthe same letter again, it selects the next item that starts with that letter.\nBut if you type different letters, then the classic Win32 ListView assumes\nthat you are typing a prefix, and it selects the first item that starts with\nthat prefix.\n\nFor example, suppose that you have a ListView with the following items:\n\n  * Cougar\n  * Leopard\n  * Lemur\n  * Lion\n  * Llama\n  * Tiger\n\nYou type L, and this selects Leopard, the first animal on the list that begins\nwith L.\n\nYou type another L. Since this is now two L\u2019s, the Win32 ListView is in\n\u201crepeated letter\u201d mode, and it selects the second L-animal, which is Lemur.\n\nNow you type A. This is no longer a repeat of the same letter, so the Win32\nListView switches to \u201cprefix\u201d mode, and it selects the first item which begins\nwith \u201cLLA\u201d, which is Llama.\n\n### Raymond Chen\n\nFollow\n\nTagged Code\n\n### Read next\n\nThe case of the exception that a catch (...) didn\u2019t catch\n\nReconstructing a false history.\n\nRaymond Chen April 5, 2024\n\n0 comment\n\nWindows debugger trick: Breaking when a specific debugger message is printed\n\nA different kind of conditional breakpoint.\n\nRaymond Chen April 3, 2024\n\n2 comments\n\n## 10 comments\n\n### Leave a commentCancel reply\n\nLog in to join the discussion or edit/delete existing comments.\n\n  * W L April 8, 2024 8:11 am 0\n\nIt seems funny at first glance, but when think about it, it makes some sense.\n\nLog in to Vote or Reply\n\n    * \u7d05\u6a13\u936e April 8, 2024 9:05 am 0\n\nIt makes sense until you want to find the item named \u201cLL\u201d and there are\nthousands of items between it and the first item beginning with L.\n\nThe fact that most computer keyboards come with a Down Arrow key might be the\nreason why I never knew the first mode of type-to-search existed.\n\nLog in to Vote or Reply\n\n    * Antonio Rodr\u00edguez April 8, 2024 11:59 am 0\n\nI knew the first mode existed back in the days of Windows 3.x, but I thought\nit had been replaced by the second mode in the Windows 95 era (makes sense for\nlarge lists of items: type the first three or four letters to navigate near\nthe item you want, then use the down arrow to hit the target). In fact, my\nowner drawn list control implements just a version of the second mode\n(complete with a timeout reset, so you can start typing another sequence right\naway if you don\u2019t find what you want).\n\nLog in to Vote or Reply\n\n  * Andreas Rejbrand April 8, 2024 9:03 am 5\n\nI love the Win32 list view control.\n\nAnd the company I work for (as a software developer) uses it very, very\nextensively.\n\nWin32 may not be the newest and hottest platform, but it is absolutely\namazing. It is extremely well suited for keyboard-heavy power users and its\nlong-term stability is simply outstanding. Apps you wrote 20 years ago or more\nstill works on Windows 11. And I feel confident that Win32 apps I develop\ntoday will still work in 20 years from now.\n\nThis is why I love Win32.\n\nLog in to Vote or Reply\n\n    * Daniel Smith April 8, 2024 9:41 am 0\n\nThis is also why I love WinForms, since most of its controls are wrappers over\nthe Win32 controls.\n\nLog in to Vote or Reply\n\n      * anonymous April 8, 2024 11:58 am 0\n\nthis comment has been deleted.\n\nLog in to Vote or Reply\n\n        * anonymous April 8, 2024 11:59 am 1\n\nThis comment has been deleted.\n\nLog in to Vote or Reply\n\n      * Georg Rottensteiner April 8, 2024 9:45 pm 1\n\nI also love WinForms, especially since the Form Designer is one of the best\navailable. I just can\u2019t get any decent GUI done with text based sourcing\n(XAML, HTML, MAUI, what the hell is that even?)\n\nIt\u2019s a blessing but also a curse. Being Win32 based it brings a whole can of\nissues when you want to do custom drawing of the controls. E.g. a tree view\ncontrol with custom drawn nodes looks fine on first glance, but the whole\nanimated expanding/collapsing animation wreaks havoc on the passed device\ncontexts.\n\nEvery now and again I attempt to do a GUI system similar to forms, but with\nfully managed background. But on the other hand it\u2019s just so much you have to\ndo: All this keyboard handling is so important, also accessability (which\nsomeone seriously botched with Forms .NET 6.0, try clicking a button that\nshows a modal OpenFileDialog)\n\nLog in to Vote or Reply\n\n      * Paulo Pinto April 9, 2024 1:41 am 0\n\nWinForms is what MFC should have been, if Microsoft teams weren\u2019t so against\nfollowing the developer experience from other C++ vendors, like OWL, VCL, Qt.\n\nSadly they never produced another worthwhile C++ framework for Windows\ndevelopment (nope, WinUI C++ isn\u2019t it).\n\nSo we\u2019re left with WinForms, WPF and eventually calling into native libraries\nfor the C++ stuff that might be needed.\n\nLog in to Vote or Reply\n\n  * Mantas M. April 8, 2024 10:13 pm 0\n\nIt seems unfortunate that the \u201cprefix\u201d mode only works if the list is\nalphabetically sorted \u2013 as soon as it isn\u2019t, the search becomes repeated-\nletter-mode only. Is there a good reason for that?\n\n(For the specific example, someone decided to stick a \u201cMatch Windows display\nlanguage\u201d at the very top of the region list in intl.cpl, and now instead of\nbeing able to type \u201cLit\u201d I have to press \u201cL L L L L L L L L L L L, oops I\novershot it, UpArrow\u201d every time.)\n\nLog in to Vote or Reply\n\n##### Code Block\n\nFeedback\n\nYour Privacy Choices Consumer Health Privacy\n\nNotifications\n\n", "frontpage": false}
