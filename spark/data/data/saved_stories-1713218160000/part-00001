{"aid": "40042225", "title": "WizardLM 2", "url": "https://wizardlm.github.io/WizardLM2/", "domain": "wizardlm.github.io", "votes": 29, "user": "tosh", "posted_at": "2024-04-15 15:54:33", "comments": 3, "source_title": "WizardLM 2", "source_text": "WizardLM 2\n\n# WizardLM 2\n\nMicrosoft AI\n\nApr 15, 2024\n\n\ud83e\udd17 Models Code arXiv [Coming]\n\nWe introduce and opensource WizardLM-2, our next generation state-of-the-art\nlarge language models, which have improved performance on complex chat,\nmultilingual, reasoning and agent. New family includes three cutting-edge\nmodels: WizardLM-2 8x22B, WizardLM-2 70B, and WizardLM-2 7B.\n\nWizardLM-2 is the latest milestone in our effort in scaling up LLM post-\ntraining. One year ago, we have been iterating on training of Wizard series\nsince our first work on Empowering Large Language Models to Follow Complex\nInstructions, then we accelerate the evolution to code and math reasoning\nscenarios. Since then, Evol-Instruct and Instruction&Process Supervised\nReinforcement Learning (RLEIF) have become fundamental technologies for GenAI\ncommunity. Recently, we have further optimized our methods and data quality,\nresulting in significant performance improvements, the outcome is WizardLM-2.\n\nWizardLM-2 8x22B is our most advanced model, and the best opensource LLM in\nour internal evaluation on highly complex tasks. WizardLM-2 70B reaches top-\ntier reasoning capabilities and is the first choice in the same size.\nWizardLM-2 7B is the fastest and achieves comparable performance with existing\n10x larger opensource leading models.\n\nFollowing, we will introduce the overall methods and main experimental\nresults, and the associated details and rethinking will be presented in our\nupcoming paper.\n\n## Method Overview\n\nAs the natural world's human-generated data becomes increasingly exhausted\nthrough LLM training, we believe that: the data carefully created by AI and\nthe model step-by-step supervised by AI will be the sole path towards more\npowerful AI.\n\nIn the past one year, we built a fully AI powered synthetic training system:\n\n  * Data Pre-Processing:\n    * Data Analysis: We use this pipline to get the distribution of different attributes for new source data. This helps us to have a preliminary understanding of the data.\n    * Weighted Sampling: The distribution of the best training data is always not consistent with the natural distribution of human chat corpus, thus we need adjust the weights of various attributes in the training data based on experimental experience.\n  * Progressive Learning: Unlike the common practice of using all data for one-time training, we found that using different data partitions and progressively training stage-by-stage can achieve better results with less data. In each stage, we firstly feed the data slice to following Evol Lab to get more diverse and complex [instruction, response] pairs. Immediately, we leverage a new framework named \"AI Align AI\" (AAA) which can group multi state-of-the-art LLMs to teach and improve each other. Finally, we successively apply the Supervised Learning, Stage-DPO, and RLEIF to optimize each variant.\n  * Evol Lab:\n    * Evol-Instruct: Recently, we have dedicated significant effort to reassessing the various issues within the original Evol-Instruct method and have initiated preliminary modifications. The new method enables various agents to automatically generate high quality instructions.\n    * Evol-Answer: Guiding the model to generate and rewrite responses multiple times can improve its logic, correctness, and affinity.\n  * AI Align AI (AAA):\n    * Co-Teaching: We collect WizardLMs, and various licensed opensource and proprietary state-of-the-art models, then let them co-teach and improve each other, the teaching contains simulated chat, quality judging, improvement suggestions and closing skill gap, etc.\n    * Self-Teaching: WizardLM can generate new evolution training data for supervised learning and preference data for reinforcement learning via activate learning from itself.\n  * Learning:\n    * Supervised Learning.\n    * Stage-DPO: For more effective offline reinforcement learning, we also split the preference data to different slices, and progressively improve the model stage by stage.\n    * RLEIF: We employ instruction quality reward model (IRM) combined with the process supervision reward model (PRM) to achieve more precise correctness in the online reinforcement learning.\n\n## WizardLM 2 Capacities\n\nTo present a comprehensive overview of the performance of WizardLM-2, we\nconduct both human and automatic evaluations between our models and diverse\nbaselines. As indicated in the following main experimental results, WizardLM-2\ndemonstrates highly competitive performance compared to those leading\nproprietary works and consistently outperforms all the existing state-of-the-\nart opensource models. More associated details and thinking will be presented\nin our upcoming paper.\n\nHuman Preferences Evaluation We carefully collected a complex and challenging\nset consisting of real-world instructions, which includes main requirements of\nhumanity, such as writing, coding, math, reasoning, agent, and multilingual.\nWe perform a blind pairwise comparison between WizardLM-2 and baselines. To\neach annotator, responses from all models are presented, which are randomly\nshuffled to hide their sources. We report the win:loss rate without tie:\n\n  * WizardLM-2 8x22B is just slightly falling behind GPT-4-1106-preview, and significantly stronger than Command R Plus and GPT4-0314.\n  * WizardLM-2 70B is better than GPT4-0613, Mistral-Large, and Qwen1.5-72B-Chat.\n  * WizardLM-2 7B is comparable with Qwen1.5-32B-Chat, and surpasses Qwen1.5-14B-Chat and Starling-LM-7B-beta.\n\nThrough this human preferences evaluation, WizardLM-2's capabilities are very\nclose to the cutting-edge proprietary models such as GPT-4-1106-preview, and\nsignificantly ahead of all the other open source models.\n\nMT-Bench We also adopt the automatic MT-Bench evaluation framework based on\nGPT-4 proposed by lmsys to assess the performance of models. The WizardLM-2\n8x22B even demonstrates highly competitive performance compared to the most\nadvanced proprietary works such as GPT-4-Trubo and Glaude-3. Meanwhile,\nWizardLM-2 7B and WizardLM-2 70B are all the top-performing models among the\nother leading baselines at 7B to 70B model scales.\n\n## Usage\n\nThe model weights of WizardLM-2 8x22B and WizardLM-2 7B are shared on\nHuggingface, and WizardLM-2 70B and the demo of all the models will be\navailable in the coming days. Please use the same system prompts strictly with\nus to guarantee the generation quality.\n\n\u2757Note for model system prompts usage: WizardLM-2 adopts the prompt format from\nVicuna and supports multi-turn conversation. The prompt should be as\nfollowing:\n\n    \n    \n    A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: Hi ASSISTANT: Hello.</s> USER: Who are you? ASSISTANT: I am WizardLM-2.</s>......\n\nInference WizardLM-2 Demo Script We provide a WizardLM-2 inference demo code\non our github.\n\n## License\n\nThe License of WizardLM-2 8x22B and WizardLM-2 7B is Apache2.0. The License of\nWizardLM-2 70B is Llama-2-Community.\n\n", "frontpage": true}
