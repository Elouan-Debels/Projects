{"aid": "39988106", "title": "Vulnerabilities Identified in LG WebOS", "url": "https://www.bitdefender.com/blog/labs/vulnerabilities-identified-in-lg-webos/", "domain": "bitdefender.com", "votes": 1, "user": "simonpure", "posted_at": "2024-04-10 07:53:31", "comments": 0, "source_title": "Vulnerabilities Identified in LG WebOS", "source_text": "Vulnerabilities Identified in LG WebOS\n\n  * Company\n  * Blog\n\nFor HomeFor BusinessFor Partners\n\nIoT Research\n\n5 min read\n\n# Vulnerabilities Identified in LG WebOS\n\nBitdefender\n\nApril 09, 2024\n\nPromo Protect all your devices, without slowing them down. Free 30-day trial\n\nAs the creator of the world\u2019s first smart home cybersecurity hub, Bitdefender\nregularly audits popular IoT hardware for vulnerabilities. This research paper\nis part of a broader program that aims to shed light on the security of the\nworld\u2019s best-sellers in the IoT space. This report covers vulnerabilities\ndiscovered while researching the LG WebOS TV operating system.\n\nWe have found several issues affecting WebOS versions 4 through 7 running on\nLG TVs. These vulnerabilities let us gain root access on the TV after\nbypassing the authorization mechanism. Although the vulnerable service is\nintended for LAN access only, Shodan, the search engine for Internet-connected\ndevices, identified over 91,000 devices that expose this service to the\nInternet.\n\n### Vulnerabilities at a glance\n\n  * Bitdefender researchers discovered a vulnerability that lets an attacker bypass the authorization mechanism in WebOS versions 4 through 7. By setting a variable, the attacker can add an extra user to the TV set (CVE-2023-6317)\n  * Another vulnerability allows attackers to elevate the access they gained in the first step to root and fully take over the device (CVE-2023-6318)\n  * A third vulnerability (CVE-2023-6319) allows operating system command injection by manipulating a library responsible with showing music lyrics.\n  * The CVE-2023-6320 vulnerability lets an attacker inject authenticated commands by manipulating the com.webos.service.connectionmanager/tv/setVlanStaticAddress API endpoint.\n\n### Vulnerable OS versions\n\n  * webOS 4.9.7 - 5.30.40 running on LG43UM7000PLA\n  * webOS 5.5.0 - 04.50.51 running on OLED55CXPUA\n  * webOS 6.3.3-442 (kisscurl-kinglake) - 03.36.50 running on OLED48C1PUB\n  * webOS 7.3.1-43 (mullet-mebin) - 03.33.85 running on OLED55A23LA\n\n### Disclosure timeline\n\n  * November 01, 2023: Vendor disclosure\n  * November 15, 2023: Vendor confirms the vulnerabilities.\n  * December 14, 2023: Vendor requests extension\n  * March 22, 2024: Patch release\n  * April 09, 2024: Public release of this report\n\n### A technical look into the discovered vulnerabilities\n\nWebOS runs a service on ports 3000/3001 (HTTP/HTTPS/WSS) which is used by the\nLG ThinkQ smartphone app to control the TV. To set up the app, the user must\nenter a PIN code into the display on the TV screen. An error in the account\nhandler lets an attacker skip the PIN verification entirely and create a\nprivileged user profile.\n\nThe function that handles account registration requests uses a variable called\nskipPrompt which is set to true when either the client-key or the companion-\nclient-key parameters correspond to an existing profile. It also takes into\nconsideration what permissions are requested when deciding whether to prompt\nthe user for a PIN, as confirmation is not required in some cases.\n\nWe can request the creation of an account with no permissions, which will be\nautomatically granted. Then we request another account with elevated\npermissions, but we specify the companion-client-key variable to match the key\nwe got when we created the first account. The server will confirm that this\nkey exists but will not verify if it belongs to the correct account. Thus, the\nskipPrompt variable will be true and the account will be created without\nrequesting a PIN confirmation on the TV.\n\nThis vulnerability, identified as CVE-2023-6317, has been confirmed to affect\nwebOS 4.9.7, 5.5.0, 6.3.3-442, and 7.3.1-43.\n\nHaving created a privileged account without user interaction, we now have\naccess to a large attack surface that was inaccessible before. We have found\ntwo authenticated command injection vulnerabilities that lead to root access,\nand another that runs commands as the dbus user.\n\n### Authenticated command injection in the processAnalyticsReport method from\nthe com.webos.service.cloudupload service\n\nThe processAnalyticsReport method requires three parameters: type, reportFile,\nand originalFile. When the type parameter is set to analytic the reportFile\nparameter will be passed to a system command without being sanitized.\n\nAlthough requests to this method cannot be performed directly, we can use\nanother endpoint, system.notifications/createAlert, to bypass this\nrestriction, accessible only to authenticated users who have the\nWRITE_NOTIFICATION_TOAST permission. The onclose parameter supported by this\nendpoint allows us to perform internal requests to services that are not\nexposed, similar to SSRF. After we create the notification, we trigger the\nonclose call through the system.notifications/closeAlert endpoint, performing\nthe request to the vulnerable endpoint.\n\nThe specified file must exist on the device, but we can bypass this constraint\nby using the download method from the com.webos.service.downloadmanager\nservice, which will create a file in the /media/internal/downloads/ directory\nwith an arbitrary filename. Both the processAnalyticsReport and download\nmethods can be accessed through the createAlert endpoint.\n\nThe vulnerable command is created on line 83 and executed on line 84:\n\nThis vulnerability, identified as CVE-2023-6318, has been confirmed to affect\nwebOS 5.5.0, 6.3.3-442, and 7.3.1-43.\n\n### Authenticated command injection in the getAudioMetadata method from the\ncom.webos.service.attachedstoragemanager service\n\nThe getAudioMetadata method requires two parameters: deviceId and fullPath.\nWhile the deviceId parameter is not important, the fullPath parameter will be\npassed, under certain conditions, to a system command without being sanitized.\nIf this parameter points to a file with the .mp3 extension the service will\nsearch in the same directory for the corresponding lyrics file with the same\nname (.lrc extension). If found, the first four bytes of the lyrics file will\nbe compared with the sequence \\xFF\\xFE\\x00\\x00. If they match (meaning that\nthe file is UTF1632 encoded) the service will try to decode it using the iconv\nbinary. This binary will be called together with the full filename without\nprior sanitization, leading to command injection.\n\nBoth the .mp3 and .lrc files must exist on the device and can be created using\nthe download method mentioned earlier. All required methods can be accessed\nthrough the createAlert endpoint.\n\nThe vulnerable code in convLrcStringByBinary from the asm binary:\n\nThis vulnerability, identified as CVE-2023-6319, has been confirmed to affect\nwebOS 4.9.7, 5.5.0, 6.3.3-442, and 7.3.1-43.\n\n### Authenticated command injection in the\ncom.webos.service.connectionmanager/tv/setVlanStaticAddress endpoint allows\nexecution of commands on the device as dbus\n\nThe setVlanStaticAddress endpoint requires three parameters: ip_address,\nbcast_address, and netmask. All threeparameters will be passed to a system\ncommand without being sanitized. Before calling this endpoint, we must first\ncall the createVirtualLan endpoint. These endpoints require the\nREAD_NETWORK_STATE permission.\n\nAlthough the user that executes the commands is dbus, this account has similar\npermissions as the root user.\n\nVulnerable code in handle_set_vlan_static_address_command from libwca2.so\nlibrary:\n\nThis vulnerability, identified as CVE-2023-6320, has been confirmed to affect\nwebOS 5.5.0 and 6.3.3-442.\n\ntags\n\nIoT Research\n\n### Author\n\n## Bitdefender\n\nThe meaning of Bitdefender\u2019s mascot, the Dacian Draco, a symbol that depicts a\nmythical animal with a wolf\u2019s head and a dragon\u2019s body, is \u201cto watch\u201d and to\n\u201cguard with a sharp eye.\u201d\n\nView all posts\n\n## Right now Top posts\n\nAnti-Malware Research\n\n### Infected Minecraft Mods Lead to Multi-Stage, Multi-Platform Infostealer\nMalware\n\nJune 08, 2023\n\n5 min read\n\nIoT Research Whitepapers\n\n### Vulnerabilities identified in Amazon Fire TV Stick, Insignia FireOS TV\nSeries\n\nMay 02, 2023\n\n2 min read\n\nAnti-Malware Research Whitepapers\n\n### EyeSpy - Iranian Spyware Delivered in VPN Installers\n\nJanuary 11, 2023\n\n2 min read\n\nAnti-Malware Research Free Tools\n\n### Bitdefender Partnership with Law Enforcement Yields MegaCortex Decryptor\n\nJanuary 05, 2023\n\n1 min read\n\n## FOLLOW US ON SOCIAL MEDIA\n\n## You might also like\n\nAnti-Malware Research\n\n### New macOS Backdoor Written in Rust Shows Possible Link with Windows\nRansomware Group\n\nAndrei LAPUSNEANU\n\nFebruary 08, 2024\n\n9 min read\n\nAnti-Malware Research\n\n### Investigating Worldwide SMS Scams, and Tens of Millions of Dollars in\nFraud\n\nAlexandra BOCEREG Marius TIVADAR Denis Cosmin NUTIU Andrei GHINEA\n\nJanuary 25, 2024\n\n9 min read\n\nIoT Research\n\n### Vulnerabilities identified in Bosch BCC100 Thermostat\n\nBitdefender\n\nJanuary 11, 2024\n\n4 min read\n\n#### Bookmarks\n\nYou have no bookmarks yet. Tap to read it later.\n\nLegal Information | Privacy Policy | Contact Us\n\nCopyright \u00a9 1997 - 2024 Bitdefender.\n\n", "frontpage": false}
