{"aid": "40044451", "title": "A tic-tac-toe game in C", "url": "https://codereview.stackexchange.com/questions/291562/a-tic-tac-toe-game-in-c", "domain": "codereview.stackexchange.com", "votes": 3, "user": "n_plus_1_acc", "posted_at": "2024-04-15 19:04:54", "comments": 0, "source_title": "A tic-tac-toe game in C", "source_text": "A tic-tac-toe game in C - Code Review Stack Exchange\n\n#### Stack Exchange Network\n\nStack Exchange network consists of 183 Q&A communities including Stack\nOverflow, the largest, most trusted online community for developers to learn,\nshare their knowledge, and build their careers.\n\nVisit Stack Exchange\n\nTeams\n\nQ&A for work\n\nConnect and share knowledge within a single location that is structured and\neasy to search.\n\nLearn more about Teams\n\n# A tic-tac-toe game in C\n\nAsk Question\n\nAsked today\n\nModified today\n\nViewed 769 times\n\nThis question shows research effort; it is useful and clear\n\n12\n\nSave this question.\n\nShow activity on this post.\n\nI am (trying) to learn the C programming language for fun with my father's\nbook \"The C Programming Language\". I tried writing a tic-tac-toe game in C. I\nhave no professional experience, so I do not know whether the following is how\nreal code is that real programmers write. I ask for your judgement.\n\n    \n    \n    #define BOARDSZ 9 #define BOARDLEN 3 #define PLYR_NO 0 #define PLYR_X 1 #define PLYR_O 2 #define PLYR_1ST 1 #define X 0 #define O 1 #define DRAW 2 #define X_WON 3 #define O_WON 4 int g_board[9]; int g_status; check() { register i, off; auto p; /* Draw */ for (i = 0; i < BOARDSZ; i++) { if (g_board[i] == PLYR_NO) goto check_win; } g_status = DRAW; return; check_win: /* Horizontal */ for (i = 0; i < BOARDLEN; i++) { off = BOARDLEN * i; if (g_board[off + 0] == PLYR_NO) continue; if (g_board[off + 0] != g_board[off + 1]) continue; if (g_board[off + 0] != g_board[off + 2]) continue; p = g_board[off + 0]; goto set_win; } /* Vertical */ for (i = 0; i < BOARDLEN; i++) { if (g_board[i + 0] == PLYR_NO) continue; if (g_board[i + 0] != g_board[i + BOARDLEN]) continue; if (g_board[i + 0] != g_board[i + BOARDLEN * 2]) continue; p = g_board[i + 0]; goto set_win; } /* Diagonal */ /* \\ */ if (g_board[0] == PLYR_NO) goto nextdiag; if (g_board[0] != g_board[4]) goto nextdiag; if (g_board[0] != g_board[8]) goto nextdiag; p = g_board[0]; goto set_win; nextdiag: /* / */ if (g_board[2] == PLYR_NO) goto end; if (g_board[2] != g_board[4]) goto end; if (g_board[2] != g_board[6]) goto end; p = g_board[2]; goto set_win; set_win: if (p == PLYR_X) g_status = X_WON; else g_status = O_WON; end: return; } init() { register i; for (i = 0; i < BOARDSZ; i++) g_board[i] = PLYR_NO; g_status = PLYR_1ST; } /* Return * 0 if success * 1 if position is already taken * 2 if game is finished */ play(pos) { if (g_status == X_WON || g_status == O_WON || g_status == DRAW) return 2; if (g_board[pos] != PLYR_NO) return 1; if (g_status == X) { g_board[pos] = PLYR_X; g_status = O; } else { g_board[pos] = PLYR_O; g_status = X; } check(); if (g_status == X_WON || g_status == O_WON || g_status == DRAW) return 2; return 0; } printbrd() { register i, j; auto p, pos; char c, chX, chO; chX = 'X'; chO = 'O'; for (i = 0; i < BOARDLEN; i++) { for (j = 0; j < BOARDLEN; j++) { pos = i * BOARDLEN + j; p = g_board[pos]; if (p == PLYR_NO) c = pos + '1'; else if (p == PLYR_X) c = chX; else c = chO; printf(\"%c\", c); } printf(\"\\n\"); } } /* if a read error, occurs, exits 1. */ char xgetchar() { auto c; c = getchar(); if (c == -1 || c == 0) { printf(\"Fatal: Could not read input\\n\"); exit(1); } /* Empty the buffer, to only consider the first char, not enter. */ if (c != '\\n') while (getchar() != '\\n'); return c; } /* Return if the user confirmed or refused. */ getyn(msg) char *msg; { char c; while (1) { printf(\"%s [Y/N]: \", msg); c = xgetchar(); if (c == 'y' || c == 'Y') return 1; if (c == 'n' || c == 'N') return 0; } } game() { char c; int pos, r; init(); printbrd(); while (1) { c = xgetchar(); if (c == 'q' || c == 'Q') { printf(\"Byte\\n\"); return; } if (c == '\\n') { printbrd(); continue; } if (c < '1' && c > '9') { printf(\"Bad input\\n\"); continue; } pos = c - '1'; r = play(pos); if (r == 0) { printbrd(); continue; } if (r == 1) { printf(\"Position already taken\\n\"); printbrd(); continue; } if (r == 2) { break; } } printbrd(); if (g_status == X_WON) printf(\"X Won!\\n\"); else if (g_status == O_WON) printf(\"O Won!\\n\"); else printf(\"It is a draw...\\n\"); } main() { while (1) { game(); if (!getyn(\"New game?\")) break; printf(\"\\n\"); } return 0; }\n\n  * c\n  * game\n  * console\n  * tic-tac-toe\n\nShare\n\nCC BY-SA 4.0\n\nFollow this question to receive notifications\n\nedited 9 hours ago\n\ntoolic\n\n3,09122 gold badges1515 silver badges4343 bronze badges\n\nasked 21 hours ago\n\nUrielUriel\n\n12122 bronze badges\n\nNew contributor\n\nUriel is a new contributor to this site. Take care in asking for\nclarification, commenting, and answering. Check out our Code of Conduct.\n\n8\n\n  * 1\n\nWhat does BOARDSZ mean? Try to name your variables in a way such that it will\nmake others understand its intended meaning. This will make your code easier\nto understand and work with.\n\n\u2013 Napoleon Bonaparte\n\n19 hours ago\n\n  * 1\n\n@NapoleonBonaparte, thank you for reading my question. It means \"board size\".\nIt is because only the first 8 characters are used. The rest is ignored,\notherwise I'd used \"BOARDSIZE\".\n\n\u2013 Uriel\n\n19 hours ago\n\n  * 1\n\nIs there a reason why you can't name your variables (in this case, constants)\nwith a more meaningful and descriptive names? I use to do the same with my\ncode; I soon found out that such practice will make debugging a lot harder.\n\n\u2013 Napoleon Bonaparte\n\n19 hours ago\n\n  * 1\n\n@NapoleonBonaparte, I do not know how to make \"BOARDSZ\" more descriptive wth\nonly 8 characters. Although, actually, since everything after the first 8\ncharacters is ignored, I could have just named it \"BOARDSIZE\" anyway. Thank\nyou.\n\n\u2013 Uriel\n\n18 hours ago\n\n  * 3\n\nThat book is a really important historical document, but it is NOT useful to\nlearn modern C in 2024. Even C has changed. Please. Please! find a newer\nsource than something that was last updated in 1988.\n\n\u2013 bitmask\n\n9 hours ago\n\n| Show 3 more comments\n\n## 2 Answers 2\n\nReset to default\n\nThis answer is useful\n\n8\n\nSave this answer.\n\nShow activity on this post.\n\nUnfortunately, it seems like you have stumbled across an older version of The\nC Programming Language which described a dialect of C now dubbed K&R C. K&R C\nwas superseded by ANSI C (C89), and has removed much of cruft prevalent in K&R\nC. As such, your code will fail to compile on any standard conforming compiler\n(at the very least, you will have to disable a bunch of standard features) and\nyour implementation would generally be considered poor 'modern C' .\n\n## No 8 character limit for identifiers\n\nANSI C does not have an 8 character limit for identifiers. So you don't need\nto constrain your identifiers to names such as BOARDSZ, printbrd, getyn, et\ncetera. In fact, a much appreciated convention in programming to have\ndescriptive names for identifiers to help other programmers' readability.\n\n## register and auto\n\nThe register keyword, while still valid, is pretty much useless. It was\noriginally designed to aid compilers as a hint that a particular variable\nshould be stored in a CPU register. Modern compilers are very smart and\nautomatically determine that; in fact, most (if not all) compilers will ignore\nthe register keyword. The alternative is to declare the variable with its\ntype: int i, off.\n\nSimilarly, the auto keyword was used by programmers to specify that a\nparticular variable is local to the scope. It is a holdover from B, the\npredecessor of C, and (again) is pretty much useless since function local\nvariables, by default, have automatic storage. Again, the alternative is to\ndeclare it using its type: int p\n\n## Specifying the return type\n\nC99 and later do not allow implicit return types (i.e., functions without a\nreturn type) and compilers will throw a big fat warning if you do so. Make\nsure you specify the return type when declaring a function.\n\n    \n    \n    int check() { ... } int init() { ... }\n\n## Old style parameter declarations\n\nOld style parameter declarations are generally considered bad form.\n\n    \n    \n    getyn(msg) char *msg; // Not good!\n\nYou will still see old C code using this style, but this has been superseded\nby declaring the arguments inside the function prototype.\n\n    \n    \n    int getyn(char* msg) // Good!\n\nNow, coming to your implementation:\n\n## Checking for the win\n\nAt each turn, you are checking the entire board for a winner. You can optimize\nthis out by keeping track of the current player ('X' or 'O') and only checking\nthe row and column the move was made in, as well as the diagonals, since the\nrest of the board is unchanged and we already know that there was no winner\nbefore the current turn.\n\n## Other comments\n\n  * Include stdio.h for printf and getchar. ANSI C does not allow implicit function calls.\n\n  * Use braces for single statement conditional and/or loop blocks. Without braces, they can become error prone and harder to read.\n    \n        if (c != '\\n') while (getchar() != '\\n');\n\ncan be replaced with:\n\n    \n        if (c != '\\n') { while (getchar() != '\\n') {} }\n\nShare\n\nCC BY-SA 4.0\n\nFollow this answer to receive notifications\n\nedited 3 hours ago\n\nanswered 11 hours ago\n\nRishRish\n\n2,17111 gold badge99 silver badges2121 bronze badges\n\n2\n\n  * You can optimize this out by keeping track of the current player ('X' or 'O') and only checking the row and column You also need to check the diagonal right?\n\n\u2013 Exprove\n\n4 hours ago\n\n  * 1\n\nYes, I missed that. Updated.\n\n\u2013 Rish\n\n3 hours ago\n\nAdd a comment |\n\nThis answer is useful\n\n4\n\nSave this answer.\n\nShow activity on this post.\n\nAdvice I - stdio.h:\n\nI was able to compile your code in Visual Studio only via adding #include\n<stdio.h>. Please, add it to your main.c.\n\nAdvice II You have:\n\n    \n    \n    int g_board[9];\n\nWhy not:\n\n    \n    \n    int g_board[BOARDSZ];\n\nAdvice III - Get rid of labels\n\nLabels - such as check_win - make the code harder to reason about. I suggest\nyou fix your logic such that you don't need them.\n\nAdvice IV - Make a board a data type I had something like this in mind:\n\n    \n    \n    typedef struct { char data[BOARDSZ]; } board_t; board_t* board_t_alloc() { board_t* b = malloc(sizeof(board_t)); memset(b->data, 0, BOARDSZ); return b; } int board_t_is_marked(board_t* b, size_t x, size_t y) { return b->data[3 * y + x]; } void board_t_mark(board_t* b, size_t x, size_t y, int player) { b->data[3 * y + x] = player; } . . . void board_t_print(board_t* b) { // Your rendering logic. }\n\nShare\n\nCC BY-SA 4.0\n\nFollow this answer to receive notifications\n\nanswered 11 hours ago\n\ncoderoddecoderodde\n\n28.1k1414 gold badges7575 silver badges190190 bronze badges\n\nAdd a comment |\n\n##\n\nNot the answer you're looking for? Browse other questions tagged\n\n  * c\n  * game\n  * console\n  * tic-tac-toe\n\nor ask your own question.\n\n  * The Overflow Blog\n  * Diverting more backdoor disasters\n\n  * How to succeed as a data engineer without the burnout\n\n  * Featured on Meta\n  * New Focus Styles & Updated Styling for Button Groups\n\n  * Upcoming initiatives on Stack Overflow and across the Stack Exchange network\n\n  * What Site Policy should we have for code written by ChatGPT?\n\n  * 2024 Community Moderator Election Results\n\n#### Related\n\n13\n\nTic Tac Toe game\n\n4\n\nTic-Tac-Toe Game\n\n3\n\nTic Tac Toe in C\n\n3\n\nJavaFX Tic-Tac-Toe Game\n\n9\n\nPygame version of my 3D Tic Tac Toe/Connect 4\n\n5\n\nFirst Tic Tac Toe game\n\n5\n\nDesign Tic tac toe game\n\n5\n\nTic tac toe game for the console\n\n3\n\nSimulate Tic Tac Toe game using C language\n\n2\n\nTic-tac-toe game for Windows console\n\n#### Hot Network Questions\n\n  * How to express a candle in a burning state?\n\n  * High-capacity floppy drives from the early 2000s, what were they?\n\n  * Metallic Puzzle\n\n  * How to create grep output in the order of the input file?\n\n  * How do you measure specific impulse Isp of a rocket engine?\n\n  * Wheel scratched carbon on ride\n\n  * Does the current \u201cruling ontology\u201d deny any possibility of a social causation of mental illness?\n\n  * Short novel. A human astronaut is exploring a huge structure in space. It has tunnels and can exit on different planets\n\n  * Print all legal chess moves\n\n  * What is \"bends\" in \"Barely even friends, then somebody bends\" (Beauty and the Beast)?\n\n  * Growing coffee indoors from cherries; to dry or not to dry?\n\n  * C-130 supreme propulsion on thought experiments\n\n  * D&D 5e: Does the same spell prepared for different levels count as multiple prepared spells or the same prepared single spell?\n\n  * Why doesnt DFT Padding cause sinc like features\n\n  * Maximum number of trailing zeros\n\n  * Can motion be oscillatory but not periodic?\n\n  * How to decompose the Naive Average Treatment Effect into the ATE, Selection Bias, and Differential Effect Bias\n\n  * How to ask Windows \"Task Manager\" to automatically maximize on startup?\n\n  * Looking for a movie or made for tv film or miniseries that I saw in the 80s. Featuring VR and the decline of humanity\n\n  * Dealing an equality with coq. - beginner's question\n\n  * Is this a photo of a historical reinactment of an 1868 treaty signing?\n\n  * Do I have to pay a licensing fee to mix in Atmos? What about other dolby formats?\n\n  * What happens if the US President-elect is sent to prison before assuming power?\n\n  * Could a Landlord (sucessfully) sue AirBnB when a tenant is subletting against their lease?\n\nQuestion feed\n\n# Subscribe to RSS\n\nlang-c\n\n  * Blog\n  * Facebook\n  * Twitter\n  * LinkedIn\n  * Instagram\n\nSite design / logo \u00a9 2024 Stack Exchange Inc; user contributions licensed\nunder CC BY-SA. rev 2024.4.12.7646\n\n## We Care About Your Privacy\n\nWe and our 4 partners store and/or access information on a device, such as\nunique IDs in cookies to process personal data. You may accept or manage your\nchoices by clicking below, including your right to object where legitimate\ninterest is used, or at any time in the privacy policy page. These choices\nwill be signaled to our partners and will not affect browsing data.\n\nCookie Policy.\n\n### We and our partners perform the following based on your settings:\n\nUse precise geolocation data. Actively scan device characteristics for\nidentification. Understand audiences through statistics or combinations of\ndata from different sources. Store and/or access information on a device.\nDevelop and improve services. Create profiles to personalise content. Measure\ncontent performance. Use limited data to select content. Measure advertising\nperformance. Use limited data to select advertising. Create profiles for\npersonalised advertising. Use profiles to select personalised advertising. Use\nprofiles to select personalised content.\n\n## About Your Privacy\n\nWe process your data to deliver content or advertisements and measure the\ndelivery of such content or advertisements to extract insights about our\nwebsite. We share this information with our partners on the basis of consent\nand legitimate interest. You may exercise your right to consent or object to a\nlegitimate interest, based on a specific purpose below or at a partner level\nin the link under each purpose. These choices will be signaled to our vendors\nparticipating in the Transparency and Consent Framework. Cookie Policy\n\n### Manage Consent Preferences\n\n#### Strictly Necessary Cookies\n\nAlways Active\n\nThese cookies are necessary for the website to function and cannot be switched\noff in our systems. They are usually only set in response to actions made by\nyou which amount to a request for services, such as setting your privacy\npreferences, logging in or filling in forms. You can set your browser to block\nor alert you about these cookies, but some parts of the site will not then\nwork. These cookies do not store any personally identifiable information.\n\n  * ##### Deliver and present advertising and content 3 partners can use this purpose\n\nlabel\n\nCertain information (like an IP address or device capabilities) is used to\nensure the technical compatibility of the content or advertising, and to\nfacilitate the transmission of the content or ad to your device.\n\n  * ##### Ensure security, prevent and detect fraud, and fix errors 3 partners can use this purpose\n\nlabel\n\nYour data can be used to monitor for and prevent unusual and possibly\nfraudulent activity (for example, regarding advertising, ad clicks by bots),\nand ensure systems and processes work properly and securely. It can also be\nused to correct any problems you, the publisher or the advertiser may\nencounter in the delivery of content and ads and in your interaction with\nthem.\n\n  * ##### Identify devices based on information transmitted automatically 3 partners can use this purpose\n\nlabel\n\nYour device might be distinguished from other devices based on information it\nautomatically sends when accessing the Internet (for instance, the IP address\nof your Internet connection or the type of browser you are using) in support\nof the purposes exposed in this notice.\n\n#### Functional Cookies\n\nThese cookies enable the website to provide enhanced functionality and\npersonalisation. They may be set by us or by third party providers whose\nservices we have added to our pages. If you do not allow these cookies then\nsome or all of these services may not function properly.\n\n  * ##### Use precise geolocation data 2 partners can use this purpose\n\nWith your acceptance, your precise location (within a radius of less than 500\nmetres) may be used in support of the purposes explained in this notice.\n\n  * ##### Link different devices 3 partners can use this purpose\n\nAlways Active\n\nIn support of the purposes explained in this notice, your device might be\nconsidered as likely linked to other devices that belong to you or your\nhousehold (for instance because you are logged in to the same service on both\nyour phone and your computer, or because you may use the same Internet\nconnection on both devices).\n\n#### Performance Cookies\n\nThese cookies allow us to count visits and traffic sources so we can measure\nand improve the performance of our site. They help us to know which pages are\nthe most and least popular and see how visitors move around the site. All\ninformation these cookies collect is aggregated and therefore anonymous. If\nyou do not allow these cookies we will not know when you have visited our\nsite, and will not be able to monitor its performance.\n\n  * ##### Store and/or access information on a device 4 partners can use this purpose\n\nCookies, device or similar online identifiers (e.g. login-based identifiers,\nrandomly assigned identifiers, network based identifiers) together with other\ninformation (e.g. browser type and information, language, screen size,\nsupported technologies etc.) can be stored or read on your device to recognise\nit each time it connects to an app or to a website, for one or several of the\npurposes presented here.\n\n  * ##### Develop and improve services 3 partners can use this purpose\n\nInformation about your activity on this service, such as your interaction with\nads or content, can be very helpful to improve products and services and to\nbuild new products and services based on user interactions, the type of\naudience, etc. This specific purpose does not include the development or\nimprovement of user profiles and identifiers.\n\n  * ##### Measure content performance 0 partners can use this purpose\n\nInformation regarding which content is presented to you and how you interact\nwith it can be used to determine whether the (non-advertising) content e.g.\nreached its intended audience and matched your interests. For instance,\nwhether you read an article, watch a video, listen to a podcast or look at a\nproduct description, how long you spent on this service and the web pages you\nvisit etc. This is very helpful to understand the relevance of (non-\nadvertising) content that is shown to you.\n\n  * ##### Measure advertising performance 4 partners can use this purpose\n\nInformation regarding which advertising is presented to you and how you\ninteract with it can be used to determine how well an advert has worked for\nyou or other users and whether the goals of the advertising were reached. For\ninstance, whether you saw an ad, whether you clicked on it, whether it led you\nto buy a product or visit a website, etc. This is very helpful to understand\nthe relevance of advertising campaigns.\n\n#### Targeting Cookies\n\nThese cookies are used to make advertising messages more relevant to you and\nmay be set through our site by us or by our advertising partners. They may be\nused to build a profile of your interests and show you relevant advertising on\nour site or on other sites. They do not store directly personal information,\nbut are based on uniquely identifying your browser and internet device.\n\n  * ##### Understand audiences through statistics or combinations of data from different sources 2 partners can use this purpose\n\nReports can be generated based on the combination of data sets (like user\nprofiles, statistics, market research, analytics data) regarding your\ninteractions and those of other users with advertising or (non-advertising)\ncontent to identify common characteristics (for instance, to determine which\ntarget audiences are more receptive to an ad campaign or to certain contents).\n\n  * ##### Create profiles to personalise content 1 partners can use this purpose\n\nInformation about your activity on this service (for instance, forms you\nsubmit, non-advertising content you look at) can be stored and combined with\nother information about you (such as your previous activity on this service or\nother websites or apps) or similar users. This is then used to build or\nimprove a profile about you (which might for example include possible\ninterests and personal aspects). Your profile can be used (also later) to\npresent content that appears more relevant based on your possible interests,\nsuch as by adapting the order in which content is shown to you, so that it is\neven easier for you to find content that matches your interests.\n\n  * ##### Use limited data to select advertising 4 partners can use this purpose\n\nAdvertising presented to you on this service can be based on limited data,\nsuch as the website or app you are using, your non-precise location, your\ndevice type or which content you are (or have been) interacting with (for\nexample, to limit the number of times an ad is presented to you).\n\n  * ##### Create profiles for personalised advertising 3 partners can use this purpose\n\nInformation about your activity on this service (such as forms you submit,\ncontent you look at) can be stored and combined with other information about\nyou (for example, information from your previous activity on this service and\nother websites or apps) or similar users. This is then used to build or\nimprove a profile about you (that might include possible interests and\npersonal aspects). Your profile can be used (also later) to present\nadvertising that appears more relevant based on your possible interests by\nthis and other entities.\n\n  * ##### Use profiles to select personalised advertising 4 partners can use this purpose\n\nAdvertising presented to you on this service can be based on your advertising\nprofiles, which can reflect your activity on this service or other websites or\napps (like the forms you submit, content you look at), possible interests and\npersonal aspects.\n\n  * ##### Use profiles to select personalised content 1 partners can use this purpose\n\nContent presented to you on this service can be based on your content\npersonalisation profiles, which can reflect your activity on this or other\nservices (for instance, the forms you submit, content you look at), possible\ninterests and personal aspects, such as by adapting the order in which content\nis shown to you, so that it is even easier for you to find (non-advertising)\ncontent that matches your interests.\n\n### Cookie List\n\nlabel\n\nConsent Leg.Interest\n\nlabel\n\nlabel\n\nlabel\n\n", "frontpage": false}
