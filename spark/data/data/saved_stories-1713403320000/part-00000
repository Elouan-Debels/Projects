{"aid": "40069014", "title": "Low-Code Automation for Image Workflows", "url": "https://api4.ai/blog/low-code-automation-for-image-workflows-with-pipedream-the-step-by-step-guide", "domain": "api4.ai", "votes": 1, "user": "todsacerdoti", "posted_at": "2024-04-17 19:19:24", "comments": 0, "source_title": "Low-Code Automation for Image Workflows with Pipedream | The Step-by-Step Guide", "source_text": "Low-Code Automation for Image Workflows with Pipedream | The Step-by-Step Guide \u2014 api4ai\n\n0\n\nSkip to Content\n\nContact Us\n\nContact Us\n\n# Low-Code Automation for Image Workflows with Pipedream | The Step-by-Step Guide\n\nApr 12\n\nWritten By Vladislav Gubarev\n\n# Introduction\n\nPipedream is a dynamic integration and automation platform designed for\ndevelopers who want to link different web applications without deep diving\ninto complex coding. The platform is particularly versatile for \"low-code\"\noperations, allowing users to deploy pre-built components for routine tasks\nwhile providing the flexibility to insert custom scripts for more tailored\nneeds. This guide will walk you through automating complex workflows, such as\ndocument handling, online file storage manipulation, and advanced image\nanalysis using artificial intelligence\u2014all through Pipedream.\n\nIn the fast-paced digital world, automating routine tasks can significantly\nboost efficiency and reduce human error. This guide focuses on automating the\ncreation of draft commercial offers for moving companies\u2014a process that\ntypically requires significant manual input and time. By harnessing AI-powered\nimage recognition and the power of low-code automation through Pipedream,\nmoving companies can instantaneously generate preliminary cost estimates based\non client-submitted photographs. This capability not only enhances customer\nservice but also streamlines internal processes, potentially giving businesses\na competitive edge.\n\n# Sample Workflow: Automating Commercial Offer Drafts\n\n## Motivation\n\nEstimating costs for services can be cumbersome, especially when those\nservices involve variable factors such as household moving. Traditionally,\nmoving companies need extensive lists of items from customers to provide even\na ballpark figure, which can be a barrier for customer engagement. This\nworkflow automates the estimation process by using photos provided by the\nclient, leveraging AI to identify and list items quickly. This rapid response\ncan prevent customers from turning to competitors and improve operational\nefficiency by reducing the workload on staff.\n\n## Description\n\nWe will create a workflow that performs the following steps:\n\n  1. Monitor a Google Drive Folder: Automatically detect new photos uploaded to a designated folder. These photos are expected to contain images of furniture and household items to be moved.\n\n  2. Process Images with AI: Use an AI-powered recognition API to analyze the photos and list identifiable items along with their quantities.\n\n  3. Generate Preliminary Offers: Create a new Google Spreadsheet document and populate it with the data obtained from the AI analysis to draft a preliminary commercial offer.\n\n# Step-by-Step Guide to Implementing the Workflow\n\nIn this tutorial, we'll walk you through setting up a sample workflow using\nPipedream's low-code platform. This workflow capitalizes on the following\napplications and actions to automate the process seamlessly:\n\n  * Google Drive: Utilized for file management, particularly for storing and monitoring new photo uploads that will trigger the workflow.\n\n  * API4AI: Deployed for its advanced capabilities in recognizing and quantifying furniture and household items within photos.\n\n  * Google Spreadsheets: Used for generating new documents that will house the preliminary data extracted and computed from the images.\n\n  * Custom Code Blocks: These will serve to integrate and automate specific actions within the workflow for enhanced functionality.\n\nPlease ensure you have an active Pipedream account to implement this workflow.\nIf you haven't registered yet, sign up at Pipedream to get started. This\naccount will allow you to access all necessary resources and deploy the\nworkflow smoothly.\n\n## Step 1: Create a Google Drive Folder\n\nBefore diving into the Pipedream workflow, the first task is to create a\ndesignated folder in Google Drive. This folder, which we will name \"Incoming\nPhotos,\" will be monitored by our workflow to detect new uploads. Here's how\nto set it up:\n\nPersonal Google Drive Users: Simply create a new folder in your existing\nGoogle Drive account and name it \"Incoming Photos\".\n\nGoogle Workspace Users: If you have a corporate account, you have the option\nto either create a standard folder in your Drive or set up a Shared Drive for\nenhanced access and collaboration across your team.\n\nThis folder will serve as the entry point for the photos that will trigger the\nautomated workflow. Ensure it is readily accessible and properly configured to\naccept file uploads.\n\n## Step 2: Create a Pipedream Workflow\n\nTo get started with your automated workflow:\n\n  1. Navigate to the Resources Tab: Locate and click the \"New\" button within the \"Resources\" tab on the Pipedream dashboard.\n\n  2. Name Your Workflow: Assign a meaningful name to your workflow that reflects its purpose.\n\n  3. Configure Workflow Parameters: Although optional, you can customize various parameters to optimize the workflow. These adjustments include setting the memory limit, toggling automatic retries on errors, and managing cold start behaviors. While many options are accessible under the free plan, some features might require a subscription to a paid plan. For simplicity, we will proceed with the default settings in this tutorial.\n\n## Step 3: Configure the \"New Files\" Trigger\n\nTo set up our workflow to respond to new file uploads automatically, we'll\nintegrate a trigger using the Google Drive app within Pipedream.\n\nAdd the Google Drive Action:\n\n  * Click the \"+\" symbol in your Pipedream workflow editor.\n\n  * Search for and select the \"Google Drive\" app.\n\n  * From the list of actions provided, find and choose \"New Files (Instant)\" to monitor new file uploads in real time.\n\nAuthenticate Your Google Drive Account:\n\n  * Upon adding the Google Drive action, you will be prompted to authenticate with your Google account. This step ensures that Pipedream can access the Google Drive where the workflow will operate.\n\n  * Follow the authentication instructions in the popup window, making sure to grant all necessary permissions by checking the \"Select all\" option.\n\nConfigure Trigger Properties:\n\n  * The \"New Files\" trigger requires you to specify which \"Drive\" and \"Folders\" it should monitor. It's crucial to select the correct values to ensure the workflow operates as intended.\n\n  * For this tutorial, choose \"My Drive\" and the \"Incoming photos\" folder. Although \"My Drive\" is typically the default option, explicitly setting it helps avoid any potential confusion.\n\nBy properly setting up this trigger, your workflow will be ready to detect any\nnew photos uploaded to the specified folder instantly, setting the stage for\nsubsequent automation steps.\n\n## Step 4: Validate the Trigger\n\nTo ensure that your trigger is set up correctly and is operational, it's\nimportant to perform a test:\n\n  1. Upload Test Files: Simply drag and drop a few photos into the \"Incoming photos\" folder on your Google Drive, which is being monitored by your Pipedream trigger.\n\n  2. Verify the Trigger Response: Observe the behavior of the trigger in Pipedream. If everything is configured correctly, the trigger should detect the new file event and activate the associated actions within your workflow.\n\nThis testing step is crucial to confirm that the workflow will function as\nexpected when new files are uploaded, thus preventing any disruptions in your\nautomated processes.\n\n## Step 5: Filter for Image Files\n\nOur workflow is designed to process images only. To ensure that no other file\ntypes disrupt the workflow, it's advisable to add a safeguard that halts the\nprocess if a non-image file is uploaded. This precaution is optional but\nhighly recommended to maintain the integrity of the workflow.\n\nHere\u2019s how to add a filter to verify the file type:\n\n  1. Identify the MIME Type:\n\n     * After successfully testing the \"New Files\" trigger, navigate to the \"Exports\" tab of the trigger's output.\n\n     * Expand the output details to locate the \"mimeType\" property of the uploaded file. This is the key property that we will check to determine the file type.\n\n  2. Add Custom Code Action:\n\n     * Below the \"New File\" trigger in your workflow, add a \"Run Custom Code\" action.\n\n     * Pipedream allows the use of several programming languages for custom code; we will use Node.js for this example. The following script checks the MIME type of the file against accepted image formats (JPEG and PNG) and terminates the workflow if the file is not an image:\n\n    \n    \n    export default defineComponent({ async run({ steps, $ }) { // Get mime type of the uploaded file using previous step data. // Abort workflow execution if uploaded file is not a PNG or JPEG file. const mimeType = steps.trigger.event.mimeType; if (mimeType.match(/image\\/(jpeg|png)$/) === null) { $.flow.exit(`${mimeType} is not acceptable. Abort workflow execution.`); } } })\n\n## Step 6: Download the Image File\n\nTo proceed with image analysis, the image file needs to be downloaded to a\nlocal storage area within the Pipedream execution environment. Pipedream\nallocates a certain amount of storage for this purpose, the extent of which\nmay vary based on your subscription plan.\n\nSetting Up the File Download:\n\n  1. Add the Download Action:\n\n     * In your workflow, add a new step by selecting the \"Google Drive\" app, then choose the \"Download file\" action.\n\n     * This action, like the \"New File\" trigger, requires authentication with your Google account. Ensure you authenticate it to access the necessary files.\n\n     * Remember to use the same Google Drive as configured in the \"New File\" trigger for consistency.\n\n  2. Configure the File and Destination Path:\n\n     * You need to specify which file to download and where to save it. For an automated workflow, these values should be dynamically set based on the files triggering the workflow.\n\n     * Set the \"File\" property to {{steps.trigger.event.id}}, which dynamically fetches the file ID from the previously triggered event.\n\n     * The output path for the downloaded file should be in a temporary directory. We recommend using the path /tmp/{{steps.trigger.event.name}} to maintain the original file name for simplicity and clarity.\n\nOnce you have configured the download parameters, conduct a test by uploading\na new photo to the designated Google Drive folder. Verify that the file is\ncorrectly downloaded to the specified path in your Pipedream workspace.\n\n## Step 7: Acquire an API Key for Image Recognition\n\nFor this workflow, we will utilize the \"Furniture & Household Items\nRecognition\" solution provided by API4AI, a prominent provider of AI-driven\ncloud-based solutions. This API will analyze the images to identify and\nquantify items, facilitating automatic estimation processes.\n\nAccessing the API:\n\n  1. Explore the API:\n\n     * Before integrating the API into your workflow, you can explore its capabilities without registration here.\n\n  2. Register and Obtain an API Key:\n\n     * Visit RapidAPI and register for an account if you haven\u2019t already. RapidAPI is a comprehensive API marketplace that hosts various APIs for different purposes.\n\n     * Subscribe to the Furniture & Household Items Recognition API provided by API4AI.\n\n     * Navigate to the API\u2019s endpoint list.\n\n     * Your API Key will be displayed under the \"Header Parameters\" section as X-RapidAPI-Key.\n\n     * For more information on how API keys function and why they are necessary, refer to RapidAPI's blog article: \"What is an API Key?\".\n\nAPI4AI offers both free and paid subscription plans. For trial purposes and\nbasic implementation within Pipedream, the free plan is usually sufficient. It\nprovides a reasonable number of credits that allow you to test and deploy your\nworkflow without immediate investment.\n\n## Step 8: Analyze the Image\n\nAt this stage, our workflow is set up to automatically detect and download new\nphotos from Google Drive into the Pipedream execution environment. Assuming\nyou have subscribed to the \"Furniture & Household Items Recognition\" API at\nthe RapidAPI hub and obtained your API key, we are now ready to proceed with\nadding the image analysis functionality.\n\nAdding the Image Recognition Action:\n\n  1. Insert the API Action: Add a new step to your workflow as you have done previously. In the app search dialog within Pipedream, type \"api4ai\" and look for the \"Furniture & Household Item Recognition\" action.\n\n  2. Configure the API Key: Input your API key in the \"Api4ai Account\" section to authenticate the action. This key should be the one you obtained from RapidAPI.\n\n  3. Set the Image Path: Specify the path where the downloaded image is stored; you should use the dynamic path constructed from the previous \"Download file\" action: /tmp/{{steps.download_file.$return_value.name}}\n\nClick the \"Test\" button to run the image recognition. This step is crucial as\nit verifies that the API correctly analyzes the image and returns the expected\ndata.\n\nBy integrating and setting up this API, the workflow will be able to analyze\nuploaded images for furniture and household items, making it a vital component\nof our automated process. This function not only enhances efficiency but also\nensures the data needed for the subsequent steps is accurate and reliable.\n\n## Step 9: Prepare a Spreadsheet Template\n\nCreating an appealing and informative offer document is crucial for making a\nprofessional impression. For this purpose, we'll use a Google Spreadsheet as a\ntemplate that can include elements like your company logo, contents, and other\nbranding essentials.\n\nSetting Up the Document Template:\n\n  1. Access the Template: You can start by using our sample template available on Google Drive. Click the link to view and make a copy of it to your Google Drive. Alternatively, you may create your own custom template that better fits your company\u2019s branding and reporting style.\n\n  2. Template Location: While you can store this document in any Google Drive folder, we recommend keeping it in the same drive as the input photos for simplicity. This reduces the complexity of managing multiple storage locations and streamlines the workflow.\n\n## Step 10: Duplicate the Template for Each Client\n\nTo manage each new incoming photo, we'll automate the creation of individual\nspreadsheet documents based on the template prepared in the previous step.\nThis involves setting up an action to duplicate the template for each photo\nprocessed. By automating the duplication of the spreadsheet template, each new\nphoto upload will trigger the creation of a new, pre-formatted document.\n\nConfiguring the Copy File Action:\n\n  1. Add the Copy File Action: In your Pipedream workflow, add a \"Copy file\" action from the \"Google Drive\" app. This action is responsible for duplicating the template spreadsheet.\n\n  2. Set the File Property: Specify the template spreadsheet that you prepared. You do not need the exact ID of the file; instead, you can easily select the template from a dropdown list presented in the user interface. This selection process uses the visual elements of the UI to simplify the configuration.\n\n## Step 11: Prepare row to add to Spreadsheet\n\nTo populate our spreadsheet with data, we need to format the output from the\nimage recognition step appropriately. This process involves a bit of custom\ncoding to transform the raw data into a structured format that can be easily\ninserted into the spreadsheet.\n\nSetting Up the Custom Code Action:\n\n  1. Add the Custom Code Action: Insert a \"Run Custom Code\" action in your workflow and name it \"prepare_rows\". This step will handle the data preparation for spreadsheet entry.\n\n  2. Code Implementation: Use the following Node.js script to structure the data into rows that the spreadsheet can accept. Each row will contain the item name, quantity, calculated price, and subtotal:\n\n    \n    \n    export default defineComponent({ async run({ steps, $ }) { // Init array of rows to return. const rows = []; // Populate rows. const items = steps.furniture_and_household_item_recognition.items; // alias for (const [item, qty] of Object.entries(items)) { const price = item.length * 2; // for simplicity we set \"price\" as twice number of chars in item name const subtotal = qty * price; rows.push([item, qty, price, subtotal]) } return rows; }, })\n\nExplanation of the Code:\n\n  * The script begins by initializing an array named rows that will store each entry for the spreadsheet.\n\n  * It then retrieves the items identified by the furniture_and_household_item_recognition step.\n\n  * For each item, the script calculates the price as twice the length of the item's name (a simplified pricing model), computes the subtotal, and appends the data as a new row in the rows array. In a real-world application, prices would typically be retrieved from a database reflecting current rates and inventory. However, for the sake of simplicity and to keep this tutorial focused on the automation aspect, we're using a basic calculation for pricing.\n\nAs with other steps, ensure to test this action to verify that the data\nformatting aligns with the needs of your spreadsheet. This ensures that when\nthe data reaches the spreadsheet, it populates accurately and consistently.\n\n## Step 12: Insert Data into the Spreadsheet\n\nNow that we have prepared the data rows from the image analysis, the final\nstep in our workflow involves populating these rows into the newly created\nspreadsheet copy.\n\nConfiguring the Action:\n\n  1. Add the 'Add Multiple Rows' Action: In your Pipedream workflow, incorporate an \"Add Multiple Rows\" action from the Google Spreadsheet app. This action is designed to batch insert data rows into a spreadsheet, making it efficient for our needs.\n\n  2. Specify the Spreadsheet ID: Set the \"Spreadsheet\" parameter to use the ID of the spreadsheet that was duplicated earlier. This is dynamically sourced from the output of the \"Copy file\" action using the placeholder {{steps.copy_file.$return_value.id}}\n\n  3. Define the Sheet Name: Explicitly specify the sheet name where the rows will be added. In this tutorial, we are using \"Sheet1\" as the target sheet.\n\n  4. Set the Rows to Insert: For the rows to be inserted, use the result from the \"prepare_rows\" action. Place the placeholder {{steps.prepare_rows.$return_value}} in the configuration to dynamically insert the processed rows.\n\nThis step completes the setup of our automated image workflow using Pipedream.\nBy automating the data entry process into a spreadsheet, we effectively reduce\nmanual data handling errors and increase efficiency, allowing for real-time\nupdates and management.\n\n## Step 13: Deploy and Test the Workflow\n\nWith all components now in place, your workflow is fully assembled and ready\nfor deployment. This final step ensures that everything functions as intended\nand that the automation provides the expected results.\n\nClick the \"Deploy\" button to finalize your workflow settings. This action\nmakes your workflow active and ready to monitor your Google Drive for new\nphoto uploads.\n\nTesting the Workflow:\n\n  1. Upload a Test Image: To test the workflow, simply upload a new photo to the \"Incoming photos\" folder in your Google Drive. This simulates the real-world usage of the workflow as it would occur when a client submits a photo.\n\n  2. Monitor Workflow Activation: Once the photo is uploaded, Pipedream will automatically trigger the workflow. The processing time is generally brief, taking just a few seconds.\n\n  3. Verify the Outcome: Upon completion of the workflow, check the status in Pipedream. A successful execution will be indicated by the status \"Success\".\n\nNavigate to your Google Drive to find the newly created or updated\nspreadsheet. Open it to ensure that it contains all the expected information\ncorrectly formatted according to the data derived from the uploaded image.\n\n# Conclusion\n\nCongratulations! You've successfully set up a complete low-code automated\nimage workflow using Pipedream. This workflow not only automates the\nestimation process for moving services based on client-submitted photos but\nalso streamlines data management, significantly reducing manual input and\nincreasing efficiency.\n\nBy integrating AI with routine workflows, companies can significantly enhance\nefficiency, reduce operational costs, and improve customer satisfaction. As we\ncontinue to embrace digital transformation, tools like Pipedream will become\nindispensable in our toolkit for innovation and business agility. Explore\nPipedream's capabilities further to discover other workflows that can benefit\nyour business.\n\nAPIhow tojavascriptpipedreamlow-codeAIGoogle DriveGoogle\nSheetsautomationworkflow\n\nVladislav Gubarev\n\nNext\n\nNext\n\n## Background Removal: Understanding It and Choosing the Best Solution\n\nCopyright \u00a9 2024 proml\n\nPowered by Proml\n\nGet Started\n\nCompany\n\nPrivacy Policy\n\nTerms of Use\n\nhello@api4.ai\n\n+1 (408) 520-9022\n\nBy using this website, you agree to our use of cookies. We use cookies to\nprovide you with great experience and to help our website run effectively.\n\n", "frontpage": false}
